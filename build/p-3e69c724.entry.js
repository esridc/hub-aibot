import{r as t,h as e}from"./p-5b036533.js";
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.8-next.4
 */const o="calcite-mode-auto";const n="calcite-mode-dark";
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.8-next.4
 */function i(){const{classList:t}=document.body;const e=window.matchMedia("(prefers-color-scheme: dark)").matches;const i=()=>t.contains(n)||t.contains(o)&&e?"dark":"light";const s=t=>document.body.dispatchEvent(new CustomEvent("calciteModeChange",{bubbles:true,detail:{mode:t}}));const a=t=>{r!==t&&s(t);r=t};let r=i();s(r);window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",(t=>a(t.matches?"dark":"light")));new MutationObserver((()=>a(i()))).observe(document.body,{attributes:true,attributeFilter:["class"]})}function s(){const t=typeof window!=="undefined"&&typeof location!=="undefined"&&typeof document!=="undefined"&&window.location===location&&window.document===document;if(t){if(document.readyState==="interactive"){i()}else{document.addEventListener("DOMContentLoaded",(()=>i()),{once:true})}}}const a=s;a();var r;(function(t){t["Nearby"]="nearby";t["Text"]="text";t["Image"]="image"})(r||(r={}));const c={nearby:"https://ajturner-refactored-space-cod-6rr7x76f4gg6-8000.preview.app.github.dev/chat",text:"https://api.openai.com/v1/chat/completions",image:"https://api.openai.com/v1/images/generations"};async function d(t){const e=await fetch(c["nearby"]+"?"+new URLSearchParams({query:t}));const o=await e.text();return o}async function l(t,e="en",o,n){var i,s;const a={en:"gpt-3.5-turbo",es:"curie",fr:"davinci"};const r=a[e]||"gpt-3.5-turbo";const d=await fetch(c["text"],{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify({model:r,messages:[{role:"system",content:o},{role:"user",content:t}],temperature:.4})});const l=await d.json();const p=(s=(i=l.choices[0])===null||i===void 0?void 0:i.message)===null||s===void 0?void 0:s.content;return p}async function p(t,e){var o;const n=await fetch(c["image"],{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({prompt:t})});const i=await n.json();const s=(o=i.data[0])===null||o===void 0?void 0:o.url;return s}const u=":host{display:block;position:fixed;bottom:20px;right:20px;z-index:9999}.fab{display:flex;justify-content:center;align-items:center;position:relative;color:white;font-size:28px;cursor:pointer;transition:width 0.3s;width:140px}.fab:hover .fab-icon{background-color:gray;border-color:#0077c2}.fab .fab-icon{width:56px;background-color:#0077c2;width:56px;height:56px;border-radius:50%;box-shadow:0px 4px 10px rgba(0, 0, 0, 0.1)}.tooltip{position:absolute;top:-30px;left:0;right:0;margin:auto;display:none;background-color:rgba(0, 0, 0, 0.8);color:white;padding:4px 8px;border-radius:4px;font-size:12px;text-align:center;pointer-events:none}.fab:hover .tooltip{display:block}.chat-window{position:fixed;bottom:90px;right:20px;width:350px;max-height:80vh;border-radius:10px;background-color:white;box-shadow:0px 4px 10px rgba(0, 0, 0, 0.1);overflow:hidden}.intro{padding:10px;font-size:14px;line-height:1.5}.messages{padding:10px;height:80%;overflow-y:scroll}.message{margin-bottom:10px;padding:10px;border-radius:10px;background-color:#f5f5f5}.loading{display:flex;align-items:center;justify-content:center;height:40px}.dot{display:inline-block;width:8px;height:8px;margin:0 2px;background-color:#0077c2;border-radius:50%;animation:dot-pulse 1.2s infinite ease-in-out}@keyframes dot-pulse{0%{transform:scale(1)}50%{transform:scale(1.3)}100%{transform:scale(1)}}.input-container{display:flex;align-items:center;padding:10px;border-top:1px solid #e0e0e0}.input{flex-grow:1;padding:6px 10px;border:none;outline:none;resize:none;font-size:14px}.send-button{display:flex;align-items:center;justify-content:center;width:36px;height:36px;border-radius:50%;background-color:#0077c2;color:white;font-size:20px;border:none;cursor:pointer;margin-left:8px}.send-button:hover{background-color:#005ea6}.example-prompts{display:flex;justify-content:center;padding:10px}.example-prompts button{margin:0 5px;padding:8px 16px;border:none;border-radius:20px;background-color:#0077c2;color:white;font-size:14px;cursor:pointer}.example-prompts button:focus{outline:none}.example-prompts button:active{background-color:#005da8}.language-buttons{display:flex;justify-content:center;margin-top:10px}.language-buttons button{margin:0 5px;padding:5px 10px;border:none;border-radius:20px;background-color:#0077c2;color:white;font-size:14px;cursor:pointer}.language-buttons button:focus{outline:none}.language-buttons button:active{background-color:#005da8}";const h=class{constructor(e){t(this,e);this.apikey="";this.model=r.Nearby;this.personality="You are writing for a government websites readable by 8th graders.";this.chatOpen=false;this.welcome=null;this.language="en";this.messages=[];this.loading=false}componentWillLoad(){if(!!this.welcome){this.messages.push({author:"AI",text:this.welcome})}}toggleChat(){this.chatOpen=!this.chatOpen}async sendMessage(){var t;const e=((t=this.chatbotRef.textContent)===null||t===void 0?void 0:t.trim())||"";this.messages=[...this.messages,{author:"AI",text:e}];this.loading=true;let o="";console.debug("calling model",[this.model,e]);switch(this.model){case r.Nearby:o=await d(e);break;case r.Text:o=await l(e,this.language,this.personality,this.apikey);break;case r.Image:o=await p(e,this.apikey);break}this.messages=[...this.messages,{author:"AI",text:o}];this.loading=false;this.chatbotRef.textContent=""}async handleKeyDown(t){if(t.key==="Enter"&&t.shiftKey===false){t.preventDefault();this.sendMessage()}}render(){return e("div",null,this.chatOpen?e("div",{class:"chat-window"},e("div",{class:"messages"},this.renderIntro(),this.messages.map((t=>e("div",{class:"message",innerHTML:t.text.replace(/(?:\r\n|\r|\n)/g,"<br>")}))),this.loading?this.renderLoading():null),e("div",{class:"input-container"},e("div",{class:"input",contentEditable:true,onKeyDown:t=>this.handleKeyDown(t),ref:t=>this.chatbotRef=t}),e("button",{class:"send-button",onClick:()=>this.sendMessage()},e("calcite-icon",{icon:"send","text-label":"Send message"})))):null,e("div",{class:"fab",onClick:()=>this.toggleChat()},e("span",{class:"tooltip"},"Open Hub Compass"),e("calcite-icon",{class:"fab-icon",icon:"explore","text-label":"Open Hub Compass"})))}renderLoading(){return e("div",{class:"loading"},e("div",{class:"dot"}),e("div",{class:"dot"}),e("div",{class:"dot"}))}renderIntro(){return e("div",{class:"intro"},e("p",null,"Welcome to the Hub Compass Chatbot!"),e("p",null,"How can I assist you today?"))}};h.style=u;export{h as hub_aibot};
//# sourceMappingURL=p-3e69c724.entry.js.map