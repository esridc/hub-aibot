{"version":3,"names":["ChatbotLayout","HubAIModel","HubChatAuthor","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__extends","__","this","constructor","prototype","create","__assign","assign","t","s","i","n","arguments","length","call","apply","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","requiresFormData","params","keys","some","key","value","toParam","type","name","processParams","newParams","forEach","_a","_b","param","firstElementType","JSON","stringify","join","valueOf","isArray","encodeParam","map","arrayElem","encodeURIComponent","encodeQueryString","encodeFormData","forceFormData","useFormData","formData_1","FormData","Blob","filename","append","Number","isInteger","knownLength","ArcGISRequestError","message","code","response","url","options","originalMessage","Error","warn","console","NODEJS_DEFAULT_REFERER_HEADER","DEFAULT_ARCGIS_REQUEST_OPTIONS","httpMethod","f","ArcGISAuthError","_super","_this","retry","getSession","retryLimit","tries","retryRequest","resolve","reject","then","session","newOptions","authentication","request","catch","Promise","checkForErrors","originalAuthError","error","messageCode","errorCode","status","parse","statusMessage","requestOptions","headers","missingGlobals","recommendedPackages","fetch","bind","Function","push","rawResponse","fetchOptions","method","credentials","getToken","err","token","getDomainCredentials","requestHeaders","hideToken","window","queryParams","urlWithQueryString","maxUrlLength","RegExp","test","body","referer","ok","status_1","statusText","json","text","blob","data","truncatedUrl","toLowerCase","split","federatedServers","expires","Date","now","appendCustomParams","customOptions","baseOptions","requestOptionsKeys","reduce","cleanUrl","trim","slice","buildUrl","host","path","query","baseUrl","endsWith","URL","search","buildQueryString","toString","filter","undefined","acc","URLSearchParams","getPortalUrl","portal","SearchQueryBuilder","q","termStack","rangeStack","openGroups","match","terms","_i","concat","in","field","fn","hasRange","hasTerms","commit","startGroup","endGroup","and","addModifier","or","not","from","term","to","boost","num","cleanup","clone","modifier","currentModifer","toUpperCase","needsQuotes","formatTerm","getTime","defineProperty","get","enumerable","configurable","oldQ","replace","genericSearch","searchType","groupId","r","nextStart","nextPage","start","createGroup","group","searchGroups","RemoteServerError","super","_RemoteServerError","authenticateRequest","tokenPromise","apiRequest","route","Headers","opts","mode","cache","apiBase","hubApiUrl","res","searchPosts","property","createPost","getCreateUpdateRequestParams","removePost","postId","mentionUrl","searchChannels","createChannel","createReaction","SortOrder","PostReaction","SharingAccess","PostStatus","DiscussionType","DiscussionSource","PostRelation","ReactionRelation","ChannelFilter","CommonSort","Role","PostSort","PostType","ChannelSort","ChannelRelation","AclCategory","AclSubCategory","hubChatHistoryKeyword","async","deleteResponse","state","context","hubRequestOptions","addResponseFeedback","reaction","EYES","findOrCreateChatHistoryGroup","chatHistoryGroup","searchResponse","debug","results","createGroupResponse","title","access","typeKeywords","success","createChatHistory","channel","groups","id","PRIVATE","chatHistoryChannel","getChatHistory","getChatChannel","posts","channels","items","addChatHistory","post","channelId","discussion","user"],"sources":["./src/types/types.ts","./node_modules/tslib/tslib.es6.js","./node_modules/@esri/arcgis-rest-request/dist/esm/utils/process-params.js","./node_modules/@esri/arcgis-rest-request/dist/esm/utils/encode-query-string.js","./node_modules/@esri/arcgis-rest-request/dist/esm/utils/encode-form-data.js","./node_modules/@esri/arcgis-rest-request/dist/esm/utils/ArcGISRequestError.js","./node_modules/@esri/arcgis-rest-request/dist/esm/utils/warn.js","./node_modules/@esri/arcgis-rest-request/dist/esm/request.js","./node_modules/@esri/arcgis-rest-request/dist/esm/utils/append-custom-params.js","./node_modules/@esri/arcgis-rest-request/dist/esm/utils/clean-url.js","./node_modules/@esri/hub-common/dist/esm/urls/build-url.js","./node_modules/@esri/arcgis-rest-portal/dist/esm/util/get-portal-url.js","./node_modules/@esri/arcgis-rest-portal/dist/esm/util/SearchQueryBuilder.js","./node_modules/@esri/arcgis-rest-portal/dist/esm/util/generic-search.js","./node_modules/@esri/arcgis-rest-portal/dist/esm/groups/create.js","./node_modules/@esri/arcgis-rest-portal/dist/esm/groups/search.js","./node_modules/@esri/hub-common/dist/esm/request.js","./node_modules/@esri/hub-discussions/dist/esm/utils/request.js","./node_modules/@esri/hub-discussions/dist/esm/request.js","./node_modules/@esri/hub-discussions/dist/esm/posts/posts.js","./node_modules/@esri/hub-discussions/dist/esm/channels/channels.js","./node_modules/@esri/hub-discussions/dist/esm/reactions/reactions.js","./node_modules/@esri/hub-discussions/dist/esm/types.js","./src/util/discussions.ts"],"sourcesContent":["\nexport enum ChatbotLayout {\n    Popup = \"popup\",\n    Modal = \"modal\"\n}\n\nexport enum HubAIModel {\n    Nearby = 'nearby',\n    Text = 'text',\n    Image = 'image'\n}\n\nexport enum HubChatAuthor {\n    user = \"user\",\n    hub = \"hub\",\n    system = \"system\"\n}\nexport type HubChatMessage = {\n    postId?: string,\n    author: string,\n    text: string,\n    action?: string\n}\nexport default HubAIModel;","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __createBinding(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (p !== \"default\" && !exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","/* Copyright (c) 2017 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\n/**\n * Checks parameters to see if we should use FormData to send the request\n * @param params The object whose keys will be encoded.\n * @return A boolean indicating if FormData will be required.\n */\nexport function requiresFormData(params) {\n    return Object.keys(params).some(function (key) {\n        var value = params[key];\n        if (!value) {\n            return false;\n        }\n        if (value && value.toParam) {\n            value = value.toParam();\n        }\n        var type = value.constructor.name;\n        switch (type) {\n            case \"Array\":\n                return false;\n            case \"Object\":\n                return false;\n            case \"Date\":\n                return false;\n            case \"Function\":\n                return false;\n            case \"Boolean\":\n                return false;\n            case \"String\":\n                return false;\n            case \"Number\":\n                return false;\n            default:\n                return true;\n        }\n    });\n}\n/**\n * Converts parameters to the proper representation to send to the ArcGIS REST API.\n * @param params The object whose keys will be encoded.\n * @return A new object with properly encoded values.\n */\nexport function processParams(params) {\n    var newParams = {};\n    Object.keys(params).forEach(function (key) {\n        var _a, _b;\n        var param = params[key];\n        if (param && param.toParam) {\n            param = param.toParam();\n        }\n        if (!param &&\n            param !== 0 &&\n            typeof param !== \"boolean\" &&\n            typeof param !== \"string\") {\n            return;\n        }\n        var type = param.constructor.name;\n        var value;\n        // properly encodes objects, arrays and dates for arcgis.com and other services.\n        // ported from https://github.com/Esri/esri-leaflet/blob/master/src/Request.js#L22-L30\n        // also see https://github.com/Esri/arcgis-rest-js/issues/18:\n        // null, undefined, function are excluded. If you want to send an empty key you need to send an empty string \"\".\n        switch (type) {\n            case \"Array\":\n                // Based on the first element of the array, classify array as an array of arrays, an array of objects\n                // to be stringified, or an array of non-objects to be comma-separated\n                // eslint-disable-next-line no-case-declarations\n                var firstElementType = (_b = (_a = param[0]) === null || _a === void 0 ? void 0 : _a.constructor) === null || _b === void 0 ? void 0 : _b.name;\n                value =\n                    firstElementType === \"Array\" ? param : // pass thru array of arrays\n                        firstElementType === \"Object\" ? JSON.stringify(param) : // stringify array of objects\n                            param.join(\",\"); // join other types of array elements\n                break;\n            case \"Object\":\n                value = JSON.stringify(param);\n                break;\n            case \"Date\":\n                value = param.valueOf();\n                break;\n            case \"Function\":\n                value = null;\n                break;\n            case \"Boolean\":\n                value = param + \"\";\n                break;\n            default:\n                value = param;\n                break;\n        }\n        if (value || value === 0 || typeof value === \"string\" || Array.isArray(value)) {\n            newParams[key] = value;\n        }\n    });\n    return newParams;\n}\n//# sourceMappingURL=process-params.js.map","/* Copyright (c) 2017 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\nimport { processParams } from \"./process-params\";\n/**\n * Encodes keys and parameters for use in a URL's query string.\n *\n * @param key Parameter's key\n * @param value Parameter's value\n * @returns Query string with key and value pairs separated by \"&\"\n */\nexport function encodeParam(key, value) {\n    // For array of arrays, repeat key=value for each element of containing array\n    if (Array.isArray(value) && value[0] && Array.isArray(value[0])) {\n        return value.map(function (arrayElem) { return encodeParam(key, arrayElem); }).join(\"&\");\n    }\n    return encodeURIComponent(key) + \"=\" + encodeURIComponent(value);\n}\n/**\n * Encodes the passed object as a query string.\n *\n * @param params An object to be encoded.\n * @returns An encoded query string.\n */\nexport function encodeQueryString(params) {\n    var newParams = processParams(params);\n    return Object.keys(newParams)\n        .map(function (key) {\n        return encodeParam(key, newParams[key]);\n    })\n        .join(\"&\");\n}\n//# sourceMappingURL=encode-query-string.js.map","/* Copyright (c) 2017 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\nimport { processParams, requiresFormData } from \"./process-params\";\nimport { encodeQueryString } from \"./encode-query-string\";\n/**\n * Encodes parameters in a [FormData](https://developer.mozilla.org/en-US/docs/Web/API/FormData) object in browsers or in a [FormData](https://github.com/form-data/form-data) in Node.js\n *\n * @param params An object to be encoded.\n * @returns The complete [FormData](https://developer.mozilla.org/en-US/docs/Web/API/FormData) object.\n */\nexport function encodeFormData(params, forceFormData) {\n    // see https://github.com/Esri/arcgis-rest-js/issues/499 for more info.\n    var useFormData = requiresFormData(params) || forceFormData;\n    var newParams = processParams(params);\n    if (useFormData) {\n        var formData_1 = new FormData();\n        Object.keys(newParams).forEach(function (key) {\n            if (typeof Blob !== \"undefined\" && newParams[key] instanceof Blob) {\n                /* To name the Blob:\n                 1. look to an alternate request parameter called 'fileName'\n                 2. see if 'name' has been tacked onto the Blob manually\n                 3. if all else fails, use the request parameter\n                */\n                var filename = newParams[\"fileName\"] || newParams[key].name || key;\n                formData_1.append(key, newParams[key], filename);\n            }\n            /* istanbul ignore next */\n            else if (newParams[key].constructor &&\n                newParams[key].constructor.name === 'ReadStream' &&\n                // TODO: only specify the knownLength option if a valid value is given.\n                // If we can verify in all REST API that the option is need for\n                // node ReadStream, it can throw an error for the missing dataSize value.\n                // Note that such change will be a breaking change.\n                Number.isInteger(newParams[\"dataSize\"])) {\n                // have to cast the formData to any so that I can use the unofficial API\n                // in the form-data library to handle Node ReadStream. See\n                // https://github.com/form-data/form-data/issues/508\n                formData_1.append(key, newParams[key], {\n                    knownLength: newParams[\"dataSize\"]\n                });\n            }\n            else {\n                formData_1.append(key, newParams[key]);\n            }\n        });\n        return formData_1;\n    }\n    else {\n        return encodeQueryString(params);\n    }\n}\n//# sourceMappingURL=encode-form-data.js.map","/* Copyright (c) 2017 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\n// TypeScript 2.1 no longer allows you to extend built in types. See https://github.com/Microsoft/TypeScript/issues/12790#issuecomment-265981442\n// and https://github.com/Microsoft/TypeScript-wiki/blob/master/Breaking-Changes.md#extending-built-ins-like-error-array-and-map-may-no-longer-work\n//\n// This code is from MDN https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error#Custom_Error_Types.\nvar ArcGISRequestError = /** @class */ (function () {\n    /**\n     * Create a new `ArcGISRequestError`  object.\n     *\n     * @param message - The error message from the API\n     * @param code - The error code from the API\n     * @param response - The original response from the API that caused the error\n     * @param url - The original url of the request\n     * @param options - The original options and parameters of the request\n     */\n    function ArcGISRequestError(message, code, response, url, options) {\n        message = message || \"UNKNOWN_ERROR\";\n        code = code || \"UNKNOWN_ERROR_CODE\";\n        this.name = \"ArcGISRequestError\";\n        this.message =\n            code === \"UNKNOWN_ERROR_CODE\" ? message : code + \": \" + message;\n        this.originalMessage = message;\n        this.code = code;\n        this.response = response;\n        this.url = url;\n        this.options = options;\n    }\n    return ArcGISRequestError;\n}());\nexport { ArcGISRequestError };\nArcGISRequestError.prototype = Object.create(Error.prototype);\nArcGISRequestError.prototype.constructor = ArcGISRequestError;\n//# sourceMappingURL=ArcGISRequestError.js.map","/* Copyright (c) 2017-2018 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\n/**\n * Method used internally to surface messages to developers.\n */\nexport function warn(message) {\n    if (console && console.warn) {\n        console.warn.apply(console, [message]);\n    }\n}\n//# sourceMappingURL=warn.js.map","/* Copyright (c) 2017-2018 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\nimport { __assign, __extends } from \"tslib\";\nimport { encodeFormData } from \"./utils/encode-form-data\";\nimport { encodeQueryString } from \"./utils/encode-query-string\";\nimport { requiresFormData } from \"./utils/process-params\";\nimport { ArcGISRequestError } from \"./utils/ArcGISRequestError\";\nimport { warn } from \"./utils/warn\";\nexport var NODEJS_DEFAULT_REFERER_HEADER = \"@esri/arcgis-rest-js\";\nvar DEFAULT_ARCGIS_REQUEST_OPTIONS = {\n    httpMethod: \"POST\",\n    params: {\n        f: \"json\",\n    },\n};\n/**\n * Sets the default options that will be passed in **all requests across all `@esri/arcgis-rest-js` modules**.\n *\n *\n * ```js\n * import { setDefaultRequestOptions } from \"@esri/arcgis-rest-request\";\n * setDefaultRequestOptions({\n *   authentication: userSession // all requests will use this session by default\n * })\n * ```\n * You should **never** set a default `authentication` when you are in a server side environment where you may be handling requests for many different authenticated users.\n *\n * @param options The default options to pass with every request. Existing default will be overwritten.\n * @param hideWarnings Silence warnings about setting default `authentication` in shared environments.\n */\nexport function setDefaultRequestOptions(options, hideWarnings) {\n    if (options.authentication && !hideWarnings) {\n        warn(\"You should not set `authentication` as a default in a shared environment such as a web server which will process multiple users requests. You can call `setDefaultRequestOptions` with `true` as a second argument to disable this warning.\");\n    }\n    DEFAULT_ARCGIS_REQUEST_OPTIONS = options;\n}\nvar ArcGISAuthError = /** @class */ (function (_super) {\n    __extends(ArcGISAuthError, _super);\n    /**\n     * Create a new `ArcGISAuthError`  object.\n     *\n     * @param message - The error message from the API\n     * @param code - The error code from the API\n     * @param response - The original response from the API that caused the error\n     * @param url - The original url of the request\n     * @param options - The original options of the request\n     */\n    function ArcGISAuthError(message, code, response, url, options) {\n        if (message === void 0) { message = \"AUTHENTICATION_ERROR\"; }\n        if (code === void 0) { code = \"AUTHENTICATION_ERROR_CODE\"; }\n        var _this = _super.call(this, message, code, response, url, options) || this;\n        _this.name = \"ArcGISAuthError\";\n        _this.message =\n            code === \"AUTHENTICATION_ERROR_CODE\" ? message : code + \": \" + message;\n        return _this;\n    }\n    ArcGISAuthError.prototype.retry = function (getSession, retryLimit) {\n        var _this = this;\n        if (retryLimit === void 0) { retryLimit = 3; }\n        var tries = 0;\n        var retryRequest = function (resolve, reject) {\n            getSession(_this.url, _this.options)\n                .then(function (session) {\n                var newOptions = __assign(__assign({}, _this.options), { authentication: session });\n                tries = tries + 1;\n                return request(_this.url, newOptions);\n            })\n                .then(function (response) {\n                resolve(response);\n            })\n                .catch(function (e) {\n                if (e.name === \"ArcGISAuthError\" && tries < retryLimit) {\n                    retryRequest(resolve, reject);\n                }\n                else if (e.name === \"ArcGISAuthError\" && tries >= retryLimit) {\n                    reject(_this);\n                }\n                else {\n                    reject(e);\n                }\n            });\n        };\n        return new Promise(function (resolve, reject) {\n            retryRequest(resolve, reject);\n        });\n    };\n    return ArcGISAuthError;\n}(ArcGISRequestError));\nexport { ArcGISAuthError };\n/**\n * Checks for errors in a JSON response from the ArcGIS REST API. If there are no errors, it will return the `data` passed in. If there is an error, it will throw an `ArcGISRequestError` or `ArcGISAuthError`.\n *\n * @param data The response JSON to check for errors.\n * @param url The url of the original request\n * @param params The parameters of the original request\n * @param options The options of the original request\n * @returns The data that was passed in the `data` parameter\n */\nexport function checkForErrors(response, url, params, options, originalAuthError) {\n    // this is an error message from billing.arcgis.com backend\n    if (response.code >= 400) {\n        var message = response.message, code = response.code;\n        throw new ArcGISRequestError(message, code, response, url, options);\n    }\n    // error from ArcGIS Online or an ArcGIS Portal or server instance.\n    if (response.error) {\n        var _a = response.error, message = _a.message, code = _a.code, messageCode = _a.messageCode;\n        var errorCode = messageCode || code || \"UNKNOWN_ERROR_CODE\";\n        if (code === 498 ||\n            code === 499 ||\n            messageCode === \"GWM_0003\" ||\n            (code === 400 && message === \"Unable to generate token.\")) {\n            if (originalAuthError) {\n                throw originalAuthError;\n            }\n            else {\n                throw new ArcGISAuthError(message, errorCode, response, url, options);\n            }\n        }\n        throw new ArcGISRequestError(message, errorCode, response, url, options);\n    }\n    // error from a status check\n    if (response.status === \"failed\" || response.status === \"failure\") {\n        var message = void 0;\n        var code = \"UNKNOWN_ERROR_CODE\";\n        try {\n            message = JSON.parse(response.statusMessage).message;\n            code = JSON.parse(response.statusMessage).code;\n        }\n        catch (e) {\n            message = response.statusMessage || response.message;\n        }\n        throw new ArcGISRequestError(message, code, response, url, options);\n    }\n    return response;\n}\n/**\n * ```js\n * import { request } from '@esri/arcgis-rest-request';\n * //\n * request('https://www.arcgis.com/sharing/rest')\n *   .then(response) // response.currentVersion === 5.2\n * //\n * request('https://www.arcgis.com/sharing/rest', {\n *   httpMethod: \"GET\"\n * })\n * //\n * request('https://www.arcgis.com/sharing/rest/search', {\n *   params: { q: 'parks' }\n * })\n *   .then(response) // response.total => 78379\n * ```\n * Generic method for making HTTP requests to ArcGIS REST API endpoints.\n *\n * @param url - The URL of the ArcGIS REST API endpoint.\n * @param requestOptions - Options for the request, including parameters relevant to the endpoint.\n * @returns A Promise that will resolve with the data from the response.\n */\nexport function request(url, requestOptions) {\n    if (requestOptions === void 0) { requestOptions = { params: { f: \"json\" } }; }\n    var options = __assign(__assign(__assign({ httpMethod: \"POST\" }, DEFAULT_ARCGIS_REQUEST_OPTIONS), requestOptions), {\n        params: __assign(__assign({}, DEFAULT_ARCGIS_REQUEST_OPTIONS.params), requestOptions.params),\n        headers: __assign(__assign({}, DEFAULT_ARCGIS_REQUEST_OPTIONS.headers), requestOptions.headers),\n    });\n    var missingGlobals = [];\n    var recommendedPackages = [];\n    // don't check for a global fetch if a custom implementation was passed through\n    if (!options.fetch && typeof fetch !== \"undefined\") {\n        options.fetch = fetch.bind(Function(\"return this\")());\n    }\n    else {\n        missingGlobals.push(\"`fetch`\");\n        recommendedPackages.push(\"`node-fetch`\");\n    }\n    if (typeof Promise === \"undefined\") {\n        missingGlobals.push(\"`Promise`\");\n        recommendedPackages.push(\"`es6-promise`\");\n    }\n    if (typeof FormData === \"undefined\") {\n        missingGlobals.push(\"`FormData`\");\n        recommendedPackages.push(\"`isomorphic-form-data`\");\n    }\n    if (!options.fetch ||\n        typeof Promise === \"undefined\" ||\n        typeof FormData === \"undefined\") {\n        throw new Error(\"`arcgis-rest-request` requires a `fetch` implementation and global variables for `Promise` and `FormData` to be present in the global scope. You are missing \" + missingGlobals.join(\", \") + \". We recommend installing the \" + recommendedPackages.join(\", \") + \" modules at the root of your application to add these to the global scope. See https://bit.ly/2KNwWaJ for more info.\");\n    }\n    var httpMethod = options.httpMethod, authentication = options.authentication, rawResponse = options.rawResponse;\n    var params = __assign({ f: \"json\" }, options.params);\n    var originalAuthError = null;\n    var fetchOptions = {\n        method: httpMethod,\n        /* ensures behavior mimics XMLHttpRequest.\n        needed to support sending IWA cookies */\n        credentials: options.credentials || \"same-origin\",\n    };\n    // the /oauth2/platformSelf route will add X-Esri-Auth-Client-Id header\n    // and that request needs to send cookies cross domain\n    // so we need to set the credentials to \"include\"\n    if (options.headers &&\n        options.headers[\"X-Esri-Auth-Client-Id\"] &&\n        url.indexOf(\"/oauth2/platformSelf\") > -1) {\n        fetchOptions.credentials = \"include\";\n    }\n    return (authentication\n        ? authentication.getToken(url, { fetch: options.fetch }).catch(function (err) {\n            /**\n             * append original request url and requestOptions\n             * to the error thrown by getToken()\n             * to assist with retrying\n             */\n            err.url = url;\n            err.options = options;\n            /**\n             * if an attempt is made to talk to an unfederated server\n             * first try the request anonymously. if a 'token required'\n             * error is thrown, throw the UNFEDERATED error then.\n             */\n            originalAuthError = err;\n            return Promise.resolve(\"\");\n        })\n        : Promise.resolve(\"\"))\n        .then(function (token) {\n        if (token.length) {\n            params.token = token;\n        }\n        if (authentication && authentication.getDomainCredentials) {\n            fetchOptions.credentials = authentication.getDomainCredentials(url);\n        }\n        // Custom headers to add to request. IRequestOptions.headers with merge over requestHeaders.\n        var requestHeaders = {};\n        if (fetchOptions.method === \"GET\") {\n            // Prevents token from being passed in query params when hideToken option is used.\n            /* istanbul ignore if - window is always defined in a browser. Test case is covered by Jasmine in node test */\n            if (params.token &&\n                options.hideToken &&\n                // Sharing API does not support preflight check required by modern browsers https://developer.mozilla.org/en-US/docs/Glossary/Preflight_request\n                typeof window === \"undefined\") {\n                requestHeaders[\"X-Esri-Authorization\"] = \"Bearer \" + params.token;\n                delete params.token;\n            }\n            // encode the parameters into the query string\n            var queryParams = encodeQueryString(params);\n            // dont append a '?' unless parameters are actually present\n            var urlWithQueryString = queryParams === \"\" ? url : url + \"?\" + encodeQueryString(params);\n            if (\n            // This would exceed the maximum length for URLs specified by the consumer and requires POST\n            (options.maxUrlLength &&\n                urlWithQueryString.length > options.maxUrlLength) ||\n                // Or if the customer requires the token to be hidden and it has not already been hidden in the header (for browsers)\n                (params.token && options.hideToken)) {\n                // the consumer specified a maximum length for URLs\n                // and this would exceed it, so use post instead\n                fetchOptions.method = \"POST\";\n                // If the token was already added as a Auth header, add the token back to body with other params instead of header\n                if (token.length && options.hideToken) {\n                    params.token = token;\n                    // Remove existing header that was added before url query length was checked\n                    delete requestHeaders[\"X-Esri-Authorization\"];\n                }\n            }\n            else {\n                // just use GET\n                url = urlWithQueryString;\n            }\n        }\n        /* updateResources currently requires FormData even when the input parameters dont warrant it.\n    https://developers.arcgis.com/rest/users-groups-and-items/update-resources.htm\n        see https://github.com/Esri/arcgis-rest-js/pull/500 for more info. */\n        var forceFormData = new RegExp(\"/items/.+/updateResources\").test(url);\n        if (fetchOptions.method === \"POST\") {\n            fetchOptions.body = encodeFormData(params, forceFormData);\n        }\n        // Mixin headers from request options\n        fetchOptions.headers = __assign(__assign({}, requestHeaders), options.headers);\n        /* istanbul ignore next - karma reports coverage on browser tests only */\n        if (typeof window === \"undefined\" && !fetchOptions.headers.referer) {\n            fetchOptions.headers.referer = NODEJS_DEFAULT_REFERER_HEADER;\n        }\n        /* istanbul ignore else blob responses are difficult to make cross platform we will just have to trust the isomorphic fetch will do its job */\n        if (!requiresFormData(params) && !forceFormData) {\n            fetchOptions.headers[\"Content-Type\"] =\n                \"application/x-www-form-urlencoded\";\n        }\n        return options.fetch(url, fetchOptions);\n    })\n        .then(function (response) {\n        if (!response.ok) {\n            // server responded w/ an actual error (404, 500, etc)\n            var status_1 = response.status, statusText = response.statusText;\n            throw new ArcGISRequestError(statusText, \"HTTP \" + status_1, response, url, options);\n        }\n        if (rawResponse) {\n            return response;\n        }\n        switch (params.f) {\n            case \"json\":\n                return response.json();\n            case \"geojson\":\n                return response.json();\n            case \"html\":\n                return response.text();\n            case \"text\":\n                return response.text();\n            /* istanbul ignore next blob responses are difficult to make cross platform we will just have to trust that isomorphic fetch will do its job */\n            default:\n                return response.blob();\n        }\n    })\n        .then(function (data) {\n        if ((params.f === \"json\" || params.f === \"geojson\") && !rawResponse) {\n            var response = checkForErrors(data, url, params, options, originalAuthError);\n            if (originalAuthError) {\n                /* If the request was made to an unfederated service that\n                didn't require authentication, add the base url and a dummy token\n                to the list of trusted servers to avoid another federation check\n                in the event of a repeat request */\n                var truncatedUrl = url\n                    .toLowerCase()\n                    .split(/\\/rest(\\/admin)?\\/services\\//)[0];\n                options.authentication.federatedServers[truncatedUrl] = {\n                    token: [],\n                    // default to 24 hours\n                    expires: new Date(Date.now() + 86400 * 1000),\n                };\n                originalAuthError = null;\n            }\n            return response;\n        }\n        else {\n            return data;\n        }\n    });\n}\n//# sourceMappingURL=request.js.map","/* Copyright (c) 2017-2018 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\nimport { __assign } from \"tslib\";\n/**\n * Helper for methods with lots of first order request options to pass through as request parameters.\n */\nexport function appendCustomParams(customOptions, keys, baseOptions) {\n    var requestOptionsKeys = [\n        \"params\",\n        \"httpMethod\",\n        \"rawResponse\",\n        \"authentication\",\n        \"portal\",\n        \"fetch\",\n        \"maxUrlLength\",\n        \"headers\"\n    ];\n    var options = __assign(__assign({ params: {} }, baseOptions), customOptions);\n    // merge all keys in customOptions into options.params\n    options.params = keys.reduce(function (value, key) {\n        if (customOptions[key] || typeof customOptions[key] === \"boolean\") {\n            value[key] = customOptions[key];\n        }\n        return value;\n    }, options.params);\n    // now remove all properties in options that don't exist in IRequestOptions\n    return requestOptionsKeys.reduce(function (value, key) {\n        if (options[key]) {\n            value[key] = options[key];\n        }\n        return value;\n    }, {});\n}\n//# sourceMappingURL=append-custom-params.js.map","/* Copyright (c) 2018 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\n/**\n * Helper method to ensure that user supplied urls don't include whitespace or a trailing slash.\n */\nexport function cleanUrl(url) {\n    // Guard so we don't try to trim something that's not a string\n    if (typeof url !== \"string\") {\n        return url;\n    }\n    // trim leading and trailing spaces, but not spaces inside the url\n    url = url.trim();\n    // remove the trailing slash to the url if one was included\n    if (url[url.length - 1] === \"/\") {\n        url = url.slice(0, -1);\n    }\n    return url;\n}\n//# sourceMappingURL=clean-url.js.map","/**\n * @private\n */\nexport function buildUrl(params) {\n    const { host, path, query } = params;\n    const baseUrl = host.endsWith(\"/\") ? host : `${host}/`;\n    const url = new URL(path, baseUrl);\n    url.search = buildQueryString(query);\n    return url.toString();\n}\nfunction buildQueryString(params = {}) {\n    const queryParams = Object.keys(params)\n        .filter((key) => {\n        return params[key] !== undefined;\n    })\n        .reduce((acc, key) => {\n        acc[key] = params[key];\n        return acc;\n    }, {});\n    return new URLSearchParams(queryParams).toString();\n}\n//# sourceMappingURL=build-url.js.map","/* Copyright (c) 2017 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\nimport { cleanUrl } from \"@esri/arcgis-rest-request\";\n/**\n * Helper that returns the appropriate portal url for a given request. `requestOptions.portal` is given\n * precedence over `authentication.portal`. If neither `portal` nor `authentication` is present,\n * `www.arcgis.com/sharing/rest` is returned.\n *\n * @param requestOptions - Request options that may have authentication manager\n * @returns Portal url to be used in API requests\n */\nexport function getPortalUrl(requestOptions) {\n    if (requestOptions === void 0) { requestOptions = {}; }\n    // use portal in options if specified\n    if (requestOptions.portal) {\n        return cleanUrl(requestOptions.portal);\n    }\n    // if auth was passed, use that portal\n    if (requestOptions.authentication) {\n        // the portal url is already scrubbed in the auth package\n        return requestOptions.authentication.portal;\n    }\n    // default to arcgis.com\n    return \"https://www.arcgis.com/sharing/rest\";\n}\n//# sourceMappingURL=get-portal-url.js.map","/* Copyright (c) 2018-2021 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\nimport { warn } from \"@esri/arcgis-rest-request\";\n/**\n * `SearchQueryBuilder` can be used to construct the `q` param for\n * [`searchItems`](/arcgis-rest-js/api/portal/searchItems#searchItems-search) or\n * [`searchGroups`](/arcgis-rest-js/api/portal/searchGroups#searchGroups-search).\n * By chaining methods, it helps build complex search queries.\n *\n * ```js\n * const startDate = new Date(\"2020-01-01\");\n * const endDate = new Date(\"2020-09-01\");\n * const query = new SearchQueryBuilder()\n *  .match(\"Patrick\")\n *  .in(\"owner\")\n *  .and()\n *  .from(startDate)\n *  .to(endDate)\n *  .in(\"created\")\n *  .and()\n *  .startGroup()\n *    .match(\"Web Mapping Application\")\n *    .in(\"type\")\n *    .or()\n *    .match(\"Mobile Application\")\n *    .in(\"type\")\n *    .or()\n *    .match(\"Application\")\n *    .in(\"type\")\n *  .endGroup()\n *  .and()\n *  .match(\"Demo App\");\n *\n * searchItems(query).then((res) => {\n *   console.log(res.results);\n * });\n * ```\n *\n * Will search for items matching\n * ```\n * \"owner: Patrick AND created:[1577836800000 TO 1598918400000] AND (type:\"Web Mapping Application\" OR type:\"Mobile Application\" OR type:Application) AND Demo App\"\n * ```\n */\nvar SearchQueryBuilder = /** @class */ (function () {\n    /**\n     * @param q An existing query string to start building from.\n     */\n    function SearchQueryBuilder(q) {\n        if (q === void 0) { q = \"\"; }\n        this.termStack = [];\n        this.rangeStack = [];\n        this.openGroups = 0;\n        this.q = q;\n    }\n    /**\n     * Defines strings to search for.\n     *\n     * ```js\n     * const query = new SearchQueryBuilder()\n     *   .match(\"My Layer\")\n     * ```\n     *\n     * @param terms strings to search for.\n     */\n    SearchQueryBuilder.prototype.match = function () {\n        var terms = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            terms[_i] = arguments[_i];\n        }\n        this.termStack = this.termStack.concat(terms);\n        return this;\n    };\n    /**\n     * Defines fields to search in. You can pass `\"*\"` or call this method without arguments to search a default set of fields\n     *\n     * ```js\n     * const query = new SearchQueryBuilder()\n     *   .match(\"My Layer\")\n     *   .in(\"title\")\n     * ```\n     *\n     * @param field The field to search for the previous match in.\n     */\n    SearchQueryBuilder.prototype.in = function (field) {\n        var fn = \"`in(\" + (field ? \"\\\"\" + field + \"\\\"\" : \"\") + \")`\";\n        if (!this.hasRange && !this.hasTerms) {\n            warn(\n            // apparently-p-rettier-ignore causes some\n            fn + \" was called with no call to `match(...)` or `from(...)`/`to(...)`. Your query was not modified.\");\n            return this;\n        }\n        if (field && field !== \"*\") {\n            this.q += field + \":\";\n        }\n        return this.commit();\n    };\n    /**\n     * Starts a new search group.\n     *\n     * ```js\n     * const query = new SearchQueryBuilder()\n     *   .startGroup()\n     *     .match(\"Lakes\")\n     *     .in(\"title\")\n     *   .endGroup()\n     *   .or()\n     *   .startGroup()\n     *     .match(\"Rivers\")\n     *     .in(\"title\")\n     *   .endGroup()\n     * ```\n     */\n    SearchQueryBuilder.prototype.startGroup = function () {\n        this.commit();\n        if (this.openGroups > 0) {\n            this.q += \" \";\n        }\n        this.openGroups++;\n        this.q += \"(\";\n        return this;\n    };\n    /**\n     * Ends a search group.\n     *\n     * ```js\n     * const query = new SearchQueryBuilder()\n     *   .startGroup()\n     *     .match(\"Lakes\")\n     *     .in(\"title\")\n     *   .endGroup()\n     *   .or()\n     *   .startGroup()\n     *     .match(\"Rivers\")\n     *     .in(\"title\")\n     *   .endGroup()\n     * ```\n     */\n    SearchQueryBuilder.prototype.endGroup = function () {\n        if (this.openGroups <= 0) {\n            warn(\"`endGroup(...)` was called without calling `startGroup(...)` first. Your query was not modified.\");\n            return this;\n        }\n        this.commit();\n        this.openGroups--;\n        this.q += \")\";\n        return this;\n    };\n    /**\n     * Joins two sets of queries with an `AND` clause.\n     *\n     * ```js\n     * const query = new SearchQueryBuilder()\n     *   .match(\"Lakes\")\n     *   .in(\"title\")\n     *   .and()\n     *   .match(\"Rivers\")\n     *   .in(\"title\")\n     * ```\n     */\n    SearchQueryBuilder.prototype.and = function () {\n        return this.addModifier(\"and\");\n    };\n    /**\n     * Joins two sets of queries with an `OR` clause.\n     *\n     * ```js\n     * const query = new SearchQueryBuilder()\n     *   .match(\"Lakes\")\n     *   .in(\"title\")\n     *   .or()\n     *   .match(\"Rivers\")\n     *   .in(\"title\")\n     * ```\n     */\n    SearchQueryBuilder.prototype.or = function () {\n        return this.addModifier(\"or\");\n    };\n    /**\n     * Joins two sets of queries with a `NOT` clause. Another option for filtering results is the [prohibit operator '-'](https://developers.arcgis.com/rest/users-groups-and-items/search-reference.htm#ESRI_SECTION1_5C6C35DB9E4A4F4492C5B937BDA2BF67).\n     *\n     * ```js\n     * // omit results with \"Rivers\" in their title\n     * const query = new SearchQueryBuilder()\n     *   .not()\n     *   .match(\"Rivers\")\n     *   .in(\"title\")\n     *\n     * // equivalent\n     * const query = new SearchQueryBuilder()\n     *   .match(\"Rivers\")\n     *   .in(\"-title\")\n     * ```\n     */\n    SearchQueryBuilder.prototype.not = function () {\n        return this.addModifier(\"not\");\n    };\n    /**\n     * Begins a new range query.\n     *\n     * ```js\n     *\n     * const NEWYEARS = new Date(\"2020-01-01\")\n     * const TODAY = new Date()\n     *\n     * const query = new SearchQueryBuilder()\n     *   .from(NEWYEARS)\n     *   .to(TODAY)\n     *   .in(\"created\")\n     * ```\n     */\n    SearchQueryBuilder.prototype.from = function (term) {\n        if (this.hasTerms) {\n            warn(\n            // apparently-p*rettier-ignore causes prettier to strip *all* comments O_o\n            \"`from(...)` is not allowed after `match(...)` try using `.from(...).to(...).in(...)`. Optionally, you may see this because dates are incorrectly formatted. Dates should be a primative Date value, aka a number in milliseconds or Date object, ie new Date(\\\"2020-01-01\\\").  Your query was not modified.\");\n            return this;\n        }\n        this.rangeStack[0] = term;\n        return this;\n    };\n    /**\n     * Ends a range query.\n     *\n     * ```js\n     * const query = new SearchQueryBuilder()\n     *   .from(yesterdaysDate)\n     *   .to(todaysDate)\n     *   .in(\"created\")\n     * ```\n     */\n    SearchQueryBuilder.prototype.to = function (term) {\n        if (this.hasTerms) {\n            warn(\n            // apparently-p*rettier-ignore causes prettier to strip *all* comments O_o\n            \"`to(...)` is not allowed after `match(...)` try using `.from(...).to(...).in(...)`. Optionally, you may see this because dates are incorrectly formatted. Dates should be a primative Date value, aka a number in milliseconds or Date object, ie new Date(\\\"2020-01-01\\\"). Your query was not modified.\");\n            return this;\n        }\n        this.rangeStack[1] = term;\n        return this;\n    };\n    /**\n     * Boosts the previous term to increase its rank in the results.\n     *\n     * ```js\n     * const query = new SearchQueryBuilder()\n     *   .match(\"Lakes\")\n     *   .in(\"title\")\n     *   .or()\n     *   .match(\"Rivers\")\n     *   .in(\"title\")\n     *   .boost(3)\n     * ```\n     */\n    SearchQueryBuilder.prototype.boost = function (num) {\n        this.commit();\n        this.q += \"^\" + num;\n        return this;\n    };\n    /**\n     * Returns the current query string. Called internally when the request is made.\n     */\n    SearchQueryBuilder.prototype.toParam = function () {\n        this.commit();\n        this.cleanup();\n        return this.q;\n    };\n    /**\n     * Returns a new instance of `SearchQueryBuilder` based on the current instance.\n     */\n    SearchQueryBuilder.prototype.clone = function () {\n        this.commit();\n        this.cleanup();\n        return new SearchQueryBuilder(this.q + \"\");\n    };\n    SearchQueryBuilder.prototype.addModifier = function (modifier) {\n        if (this.currentModifer) {\n            warn(\n            // apparently-p*rettier-ignore causes prettier to strip *all* comments O_o\n            \"You have called `\" + this.currentModifer + \"()` after `\" + modifier + \"()`. Your current query was not modified.\");\n            return this;\n        }\n        this.commit();\n        if (this.q === \"\" && modifier !== \"not\") {\n            warn(\"You have called `\" + modifier + \"()` without calling another method to modify your query first. Try calling `match()` first.\");\n            return this;\n        }\n        this.currentModifer = modifier;\n        this.q += this.q === \"\" ? \"\" : \" \";\n        this.q += modifier.toUpperCase() + \" \";\n        return this;\n    };\n    SearchQueryBuilder.prototype.needsQuotes = function (s) {\n        return /\\s|:/g.test(s);\n    };\n    SearchQueryBuilder.prototype.formatTerm = function (term) {\n        if (term instanceof Date) {\n            return term.getTime();\n        }\n        if (typeof term === \"string\" && this.needsQuotes(term)) {\n            return \"\\\"\" + term + \"\\\"\";\n        }\n        return term;\n    };\n    SearchQueryBuilder.prototype.commit = function () {\n        var _this = this;\n        this.currentModifer = undefined;\n        if (this.hasRange) {\n            this.q += \"[\" + this.formatTerm(this.rangeStack[0]) + \" TO \" + this.formatTerm(this.rangeStack[1]) + \"]\";\n            this.rangeStack = [undefined, undefined];\n        }\n        if (this.hasTerms) {\n            this.q += this.termStack\n                .map(function (term) {\n                return _this.formatTerm(term);\n            })\n                .join(\" \");\n            this.termStack = [];\n        }\n        return this;\n    };\n    Object.defineProperty(SearchQueryBuilder.prototype, \"hasTerms\", {\n        get: function () {\n            return this.termStack.length > 0;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SearchQueryBuilder.prototype, \"hasRange\", {\n        get: function () {\n            return this.rangeStack.length && this.rangeStack[0] && this.rangeStack[1];\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SearchQueryBuilder.prototype.cleanup = function () {\n        // end a group if we have started one\n        if (this.openGroups > 0) {\n            warn(\n            // apparently-p*rettier-ignore causes prettier to strip *all* comments O_o\n            \"Automatically closing \" + this.openGroups + \" group(s). You can use `endGroup(...)` to remove this warning.\");\n            while (this.openGroups > 0) {\n                this.q += \")\";\n                this.openGroups--;\n            }\n        }\n        var oldQ = this.q;\n        this.q = oldQ.replace(/( AND ?| NOT ?| OR ?)*$/, \"\");\n        if (oldQ !== this.q) {\n            warn(\"`startGroup(...)` was called without calling `endGroup(...)` first. Your query was not modified.\");\n        }\n        // clear empty groups\n        this.q = this.q.replace(/(\\(\\))*/, \"\");\n    };\n    return SearchQueryBuilder;\n}());\nexport { SearchQueryBuilder };\n//# sourceMappingURL=SearchQueryBuilder.js.map","/* Copyright (c) 2018 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\nimport { request, appendCustomParams, } from \"@esri/arcgis-rest-request\";\nimport { SearchQueryBuilder } from \"./SearchQueryBuilder\";\nimport { getPortalUrl } from \"../util/get-portal-url\";\nexport function genericSearch(search, searchType) {\n    var options;\n    if (typeof search === \"string\" || search instanceof SearchQueryBuilder) {\n        options = {\n            httpMethod: \"GET\",\n            params: {\n                q: search,\n            },\n        };\n    }\n    else {\n        // searchUserAccess has one (knonw) valid value: \"groupMember\"\n        options = appendCustomParams(search, [\n            \"q\",\n            \"num\",\n            \"start\",\n            \"sortField\",\n            \"sortOrder\",\n            \"searchUserAccess\",\n            \"searchUserName\",\n            \"filter\",\n            \"countFields\",\n            \"countSize\",\n            \"categories\",\n            \"categoryFilters\",\n        ], {\n            httpMethod: \"GET\",\n        });\n    }\n    var path;\n    switch (searchType) {\n        case \"item\":\n            path = \"/search\";\n            break;\n        case \"group\":\n            path = \"/community/groups\";\n            break;\n        case \"groupContent\":\n            // Need to have groupId property to do group contents search,\n            // cso filter out all but ISearchGroupContentOptions\n            if (typeof search !== \"string\" &&\n                !(search instanceof SearchQueryBuilder) &&\n                search.groupId) {\n                path = \"/content/groups/\" + search.groupId + \"/search\";\n            }\n            else {\n                return Promise.reject(new Error(\"you must pass a `groupId` option to `searchGroupContent`\"));\n            }\n            break;\n        default:\n            // \"users\"\n            path = \"/portals/self/users/search\";\n            break;\n    }\n    var url = getPortalUrl(options) + path;\n    // send the request\n    return request(url, options).then(function (r) {\n        if (r.nextStart && r.nextStart !== -1) {\n            r.nextPage = function () {\n                var newOptions;\n                if (typeof search === \"string\" ||\n                    search instanceof SearchQueryBuilder) {\n                    newOptions = {\n                        q: search,\n                        start: r.nextStart,\n                    };\n                }\n                else {\n                    newOptions = search;\n                    newOptions.start = r.nextStart;\n                }\n                return genericSearch(newOptions, searchType);\n            };\n        }\n        return r;\n    });\n}\n//# sourceMappingURL=generic-search.js.map","/* Copyright (c) 2017-2018 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\nimport { __assign } from \"tslib\";\nimport { request } from \"@esri/arcgis-rest-request\";\nimport { getPortalUrl } from \"../util/get-portal-url\";\n/**\n * ```js\n * import { createGroup } from \"@esri/arcgis-rest-portal\";\n * //\n * createGroup({\n *   group: {\n *     title: \"No Homers\",\n *     access: \"public\"\n *   },\n *   authentication\n * })\n *   .then(response)\n * ```\n * Create a new Group. See the [REST Documentation](https://developers.arcgis.com/rest/users-groups-and-items/create-group.htm) for more information.\n *\n * Note: The group name must be unique within the user's organization.\n * @param requestOptions  - Options for the request, including a group object\n * @returns A Promise that will resolve with the success/failure status of the request\n */\nexport function createGroup(requestOptions) {\n    var url = getPortalUrl(requestOptions) + \"/community/createGroup\";\n    requestOptions.params = __assign(__assign({}, requestOptions.params), requestOptions.group);\n    return request(url, requestOptions);\n}\n//# sourceMappingURL=create.js.map","/* Copyright (c) 2018-2019 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\nimport { genericSearch } from \"../util/generic-search\";\n/**\n * ```js\n * import { searchGroups } from \"@esri/arcgis-rest-portal\";\n * //\n * searchGroups('water')\n *   .then(response) // response.total => 355\n * ```\n * Search a portal for groups. See the [REST Documentation](https://developers.arcgis.com/rest/users-groups-and-items/group-search.htm) for more information.\n *\n * @param search - A string or RequestOptions object to pass through to the endpoint.\n * @returns A Promise that will resolve with the data from the response.\n */\nexport function searchGroups(search) {\n    return genericSearch(search, \"group\");\n}\n/**\n * ```js\n * import { searchGroupContent } from \"@esri/arcgis-rest-portal\";\n * //\n * searchGroupContent('water')\n *   .then(response) // response.total => 355\n * ```\n * Search a portal for items in a group. See the [REST Documentation](https://developers.arcgis.com/rest/users-groups-and-items/group-content-search.htm) for more information.\n *\n * @param options - RequestOptions object amended with search parameters.\n * @returns A Promise that will resolve with the data from the response.\n */\nexport function searchGroupContent(options) {\n    return genericSearch(options, \"groupContent\");\n}\n//# sourceMappingURL=search.js.map","import { getHubApiUrl } from \"./api\";\nimport { buildUrl } from \"./urls/build-url\";\n/**\n * remote server error\n */\nexport class RemoteServerError extends Error {\n    constructor(message, url, status) {\n        super(message);\n        this.status = status;\n        this.url = url;\n    }\n}\n/**\n * ```js\n * import { hubApiRequest } from \"@esri/hub-common\";\n * //\n * hubApiRequest(\n *   \"/datasets\",\n *   requestOptions\n * })\n *   .then(response);\n * ```\n * make a request to the Hub API\n * @param route API route\n * @param requestOptions request options\n */\nexport function hubApiRequest(route, requestOptions) {\n    // merge in default request options\n    const options = Object.assign({ \n        // why do we default to GET w/ our API?\n        httpMethod: \"GET\" }, requestOptions);\n    // use fetch override if any\n    const _fetch = options.fetch || fetch;\n    // merge in default headers\n    const headers = Object.assign({ \"Content-Type\": \"application/json\" }, options.headers);\n    // build query params/body based on requestOptions.params\n    let query;\n    let body;\n    if (options.httpMethod === \"GET\") {\n        // pass params in query string\n        query = options.params;\n    }\n    else {\n        // pass params in request body\n        body = JSON.stringify(options.params);\n    }\n    // build Hub API URL\n    const url = buildUrl({\n        host: getHubApiUrl(options),\n        path: `/api/v3/${route}`.replace(/\\/\\//g, \"/\"),\n        query,\n    });\n    return _fetch(url, {\n        method: options.httpMethod,\n        headers,\n        body,\n    }).then((resp) => {\n        if (resp.ok) {\n            return resp.json();\n        }\n        else {\n            throw new RemoteServerError(resp.statusText, url, resp.status);\n        }\n    });\n}\n//# sourceMappingURL=request.js.map","import { RemoteServerError as _RemoteServerError, buildUrl, } from \"@esri/hub-common\";\nexport class RemoteServerError extends _RemoteServerError {\n    constructor(message, url, status, error) {\n        super(message, url, status);\n        this.error = error;\n    }\n}\n/**\n * returns Promise that resolves token to use in Discussions API requests\n *\n * @export\n * @param {IDiscussionsRequestOptions} options\n * @return {*}  {Promise<string>}\n */\nexport function authenticateRequest(options) {\n    const { token, authentication } = options;\n    let tokenPromise = () => {\n        return Promise.resolve(token);\n    };\n    if (authentication) {\n        tokenPromise = authentication.getToken.bind(authentication, authentication.portal);\n    }\n    return tokenPromise();\n}\n/**\n * parses IHubRequestOptions and makes request against Discussions API\n *\n * @export\n * @template T\n * @param {string} route\n * @param {IDiscussionsRequestOptions} options\n * @param {string} [token]\n * @return {*}  {Promise<T>}\n */\nexport function apiRequest(route, options, token) {\n    const headers = new Headers(options.headers);\n    headers.append(\"Content-Type\", \"application/json\");\n    if (token) {\n        headers.append(\"Authorization\", `Bearer ${token}`);\n    }\n    const opts = {\n        headers,\n        method: options.httpMethod || \"GET\",\n        mode: options.mode,\n        cache: options.cache,\n        credentials: options.credentials,\n    };\n    const apiBase = buildUrl({\n        // TODO: we _want_ to use getHubApiUrl(),\n        // but have to deal w/ the fact that this package overwrites IHubRequestOptions\n        host: options.hubApiUrl || \"https://hub.arcgis.com\",\n        path: \"/api/discussions/v1\",\n    });\n    if (options.data) {\n        if (options.httpMethod === \"GET\") {\n            const queryParams = new URLSearchParams(options.data).toString();\n            route += `?${queryParams}`;\n        }\n        else {\n            opts.body = JSON.stringify(options.data);\n        }\n    }\n    const url = [apiBase.replace(/\\/$/, \"\"), route.replace(/^\\//, \"\")].join(\"/\");\n    return fetch(url, opts).then((res) => {\n        if (res.ok) {\n            return res.json();\n        }\n        else {\n            const { statusText, status } = res;\n            return res.json().then((err) => {\n                throw new RemoteServerError(statusText, url, status, JSON.stringify(err.message));\n            });\n        }\n    });\n}\n//# sourceMappingURL=request.js.map","import { apiRequest, authenticateRequest } from \"./utils/request\";\n/**\n * method that authenticates and makes requests to Discussions API\n *\n * @export\n * @template T\n * @param {string} url\n * @param {IDiscussionsRequestOptions} options\n * @return {*}  {Promise<T>}\n */\n// NOTE: feasibly this could be replaced with @esi/hub-common hubApiRequest,\n// if that method didn't prepend `/api/v3` to the supplied path. Additionally,\n// there is the difference that hubApiRequest sets Authorization header without `Bearer`\n// https://github.com/Esri/hub.js/blob/f35b1a0a868916bd07e1dfd84cb084bc2c876267/packages/common/src/request.ts#L62\nexport function request(url, options) {\n    return authenticateRequest(options).then((token) => {\n        return apiRequest(url, options, token);\n    });\n}\n//# sourceMappingURL=request.js.map","import { __rest } from \"tslib\";\n/* tslint:disable unified-signatures */\nimport { request } from \"../request\";\n/**\n * search posts\n *\n * @export\n * @param {ISearchPostsParams} options\n * @return {*}  {Promise<IPagedResponse<IPost>>}\n */\nexport function searchPosts(options) {\n    var _a;\n    const url = `/posts`;\n    // need to serialize geometry and featureGeometry since this\n    // is a GET request. we should consider requiring this to be\n    // a base64 string to safeguard against large geometries that\n    // will exceed URL character limits\n    const data = [\"geometry\", \"featureGeometry\"].reduce((acc, property) => acc[property]\n        ? Object.assign(Object.assign({}, acc), { [property]: JSON.stringify(acc[property]) }) : acc, Object.assign({}, ((_a = options.data) !== null && _a !== void 0 ? _a : {})));\n    return request(url, Object.assign(Object.assign({}, options), { data, httpMethod: \"GET\" }));\n}\n/**\n * create post\n *\n * @export\n * @param {ICreatePostParams} options\n * @return {*}  {Promise<IPost>}\n */\nexport function createPost(options) {\n    const url = `/posts`;\n    return request(url, Object.assign({ httpMethod: \"POST\" }, getCreateUpdateRequestParams(options)));\n}\n/**\n * create reply to post\n *\n * @export\n * @param {string} parentId\n * @param {ICreateReplyParams} options\n * @return {*}  {Promise<IPost>}\n */\nexport function createReply(options) {\n    const url = `/posts/${options.postId}/reply`;\n    return request(url, Object.assign({ httpMethod: \"POST\" }, getCreateUpdateRequestParams(options)));\n}\n/**\n * fetch post\n *\n * @export\n * @param {IFetchPostParams} params\n * @return {*}  {Promise<IPost>}\n */\nexport function fetchPost(params) {\n    const url = `/posts/${params.postId}`;\n    params.httpMethod = \"GET\";\n    return request(url, params);\n}\n/**\n * remove post\n *\n * @export\n * @param {IRemovePostParams} options\n * @return {*}  {Promise<IRemovePostResponse>}\n */\nexport function removePost(options) {\n    const url = `/posts/${options.postId}`;\n    options.httpMethod = \"DELETE\";\n    return request(url, options);\n}\n/**\n * update post\n * NOTE: this method currently only update post.title and post.body\n *\n * @export\n * @param {IUpdatePostParams} options\n * @return {*}  {Promise<IPost>}\n */\nexport function updatePost(options) {\n    const url = `/posts/${options.postId}`;\n    return request(url, Object.assign({ httpMethod: \"PATCH\" }, getCreateUpdateRequestParams(options)));\n}\n/**\n * update post status\n * NOTE: this method will only update a post's status\n *\n * @export\n * @param {IUpdatePostStatusParams} options\n * @return {*}  {Promise<IPost>}\n */\nexport function updatePostStatus(options) {\n    const url = `/posts/${options.postId}/status`;\n    options.httpMethod = \"PATCH\";\n    return request(url, options);\n}\n/**\n * Builds the necessary request options for post/reply create/update requests\n * @param mentionUrl\n */\nfunction getCreateUpdateRequestParams(params) {\n    const { mentionUrl } = params, requestOptions = __rest(params, [\"mentionUrl\"]);\n    if (mentionUrl) {\n        requestOptions.headers = Object.assign(Object.assign({}, requestOptions.headers), { \"mention-url\": mentionUrl });\n    }\n    return requestOptions;\n}\n//# sourceMappingURL=posts.js.map","import { request } from \"../request\";\n/**\n * search channels\n *\n * @export\n * @param {ISearchChannelsParams} options\n * @return {*}  {Promise<IPagedResponse<IChannel>>}\n */\nexport function searchChannels(options) {\n    options.httpMethod = \"GET\";\n    return request(`/channels`, options);\n}\n/**\n * create channel\n *\n * @export\n * @param {ICreateChannelParams} options\n * @return {*}  {Promise<IChannel>}\n */\nexport function createChannel(options) {\n    options.httpMethod = \"POST\";\n    return request(`/channels`, options);\n}\n/**\n * fetch channel\n *\n * @export\n * @param {IFetchChannelParams} options\n * @return {*}  {Promise<IChannel>}\n */\nexport function fetchChannel(options) {\n    options.httpMethod = \"GET\";\n    return request(`/channels/${options.channelId}`, options);\n}\n/**\n * update channel\n * NOTE: only updates channel settings properties (softDelete, allowedReactions, etc). A Channel's\n * access and groups cannot be updated.\n *\n * @export\n * @param {IUpdateChannelParams} options\n * @return {*}  {Promise<IChannel>}\n */\nexport function updateChannel(options) {\n    options.httpMethod = \"PATCH\";\n    return request(`/channels/${options.channelId}`, options);\n}\n/**\n * remove channel\n *\n * @export\n * @param {IRemoveChannelParams} options\n * @return {*}\n */\nexport function removeChannel(options) {\n    options.httpMethod = \"DELETE\";\n    return request(`/channels/${options.channelId}`, options);\n}\n/**\n * get channel opt out status\n *\n * @export\n * @param {IFetchChannelNotificationOptOutParams} options\n * @return {*}\n */\nexport function fetchChannelNotifcationOptOut(options) {\n    options.httpMethod = \"GET\";\n    return request(`/channels/${options.channelId}/notifications/opt-out`, options);\n}\n/**\n * opt out of channel notifs\n *\n * @export\n * @param {ICreateChannelNotificationOptOutParams} options\n * @return {*}\n */\nexport function createChannelNotificationOptOut(options) {\n    options.httpMethod = \"POST\";\n    return request(`/channels/${options.channelId}/notifications/opt-out`, options);\n}\n/**\n * opt in to channel notifs\n *\n * @export\n * @param {IRemoveChannelNotificationOptOutParams} options\n * @return {*}\n */\nexport function removeChannelNotificationOptOut(options) {\n    options.httpMethod = \"DELETE\";\n    return request(`/channels/${options.channelId}/notifications/opt-out`, options);\n}\n/**\n * remove all posts in a channel\n *\n * @export\n * @param {IRemoveChannelActivityParams} options\n * @return {*}\n */\nexport function removeChannelActivity(options) {\n    options.httpMethod = \"DELETE\";\n    return request(`/channels/${options.channelId}/activity`, options);\n}\n//# sourceMappingURL=channels.js.map","import { request } from \"../request\";\n/**\n * create reaction to post\n *\n * @export\n * @param {ICreateReactionOptions} options\n * @return {*}  {Promise<IReaction>}\n */\nexport function createReaction(options) {\n    options.httpMethod = \"POST\";\n    return request(`/reactions`, options);\n}\n/**\n * remove reaction\n *\n * @export\n * @param {IRemoveReactionOptions} options\n * @return {*}  {Promise<IRemoveReactionResponse>}\n */\nexport function removeReaction(options) {\n    const { reactionId } = options;\n    options.httpMethod = \"DELETE\";\n    return request(`/reactions/${reactionId}`, options);\n}\n//# sourceMappingURL=reactions.js.map","/**\n * sort orders\n *\n * @export\n * @enum {string}\n */\nexport var SortOrder;\n(function (SortOrder) {\n    SortOrder[\"ASC\"] = \"ASC\";\n    SortOrder[\"DESC\"] = \"DESC\";\n})(SortOrder || (SortOrder = {}));\n/**\n * reactions to posts\n *\n * @export\n * @enum {string}\n */\nexport var PostReaction;\n(function (PostReaction) {\n    PostReaction[\"CLAPPING_HANDS\"] = \"clapping_hands\";\n    PostReaction[\"CONFUSED\"] = \"confused\";\n    PostReaction[\"DOWN_ARROW\"] = \"down_arrow\";\n    PostReaction[\"EYES\"] = \"eyes\";\n    PostReaction[\"FACE_WITH_TEARS_OF_JOY\"] = \"face_with_tears_of_joy\";\n    PostReaction[\"FIRE\"] = \"fire\";\n    PostReaction[\"GRINNING\"] = \"grinning\";\n    PostReaction[\"HEART\"] = \"heart\";\n    PostReaction[\"LAUGH\"] = \"laugh\";\n    PostReaction[\"ONE_HUNDRED\"] = \"one_hundred\";\n    PostReaction[\"PARTYING\"] = \"partying\";\n    PostReaction[\"PARTY_POPPER\"] = \"party_popper\";\n    PostReaction[\"RAISING_HANDS\"] = \"raising_hands\";\n    PostReaction[\"ROCKET\"] = \"rocket\";\n    PostReaction[\"SAD\"] = \"sad\";\n    PostReaction[\"SLIGHTLY_SMILING\"] = \"slightly_smiling\";\n    PostReaction[\"SURPRISED\"] = \"surprised\";\n    PostReaction[\"THINKING\"] = \"thinking\";\n    PostReaction[\"THUMBS_UP\"] = \"thumbs_up\";\n    PostReaction[\"THUMBS_DOWN\"] = \"thumbs_down\";\n    PostReaction[\"TROPHY\"] = \"trophy\";\n    PostReaction[\"UP_ARROW\"] = \"up_arrow\";\n    PostReaction[\"WAVING_HAND\"] = \"waving_hand\";\n    PostReaction[\"WINKING\"] = \"winking\";\n    PostReaction[\"WORLD_MAP\"] = \"world_map\";\n})(PostReaction || (PostReaction = {}));\n/**\n * platform sharing access values\n *\n * @export\n * @enum {string}\n */\nexport var SharingAccess;\n(function (SharingAccess) {\n    SharingAccess[\"PUBLIC\"] = \"public\";\n    SharingAccess[\"ORG\"] = \"org\";\n    SharingAccess[\"PRIVATE\"] = \"private\";\n})(SharingAccess || (SharingAccess = {}));\n/**\n * possible statuses of a post\n *\n * @export\n * @enum {string}\n */\nexport var PostStatus;\n(function (PostStatus) {\n    PostStatus[\"PENDING\"] = \"pending\";\n    PostStatus[\"APPROVED\"] = \"approved\";\n    PostStatus[\"REJECTED\"] = \"rejected\";\n    PostStatus[\"DELETED\"] = \"deleted\";\n    PostStatus[\"HIDDEN\"] = \"hidden\";\n})(PostStatus || (PostStatus = {}));\n/**\n * possible discussionn content types, i.e. a post can be about an item, dataset, or group\n *\n * @export\n * @enum {string}\n */\nexport var DiscussionType;\n(function (DiscussionType) {\n    DiscussionType[\"GROUP\"] = \"group\";\n    DiscussionType[\"CONTENT\"] = \"content\";\n    DiscussionType[\"BOARD\"] = \"board\";\n})(DiscussionType || (DiscussionType = {}));\n/**\n * source of a post, i.e. app context\n *\n * @export\n * @enum {string}\n */\nexport var DiscussionSource;\n(function (DiscussionSource) {\n    DiscussionSource[\"HUB\"] = \"hub\";\n    DiscussionSource[\"AGO\"] = \"ago\";\n    DiscussionSource[\"URBAN\"] = \"urban\";\n})(DiscussionSource || (DiscussionSource = {}));\n/**\n * relations of post entity\n *\n * @export\n * @enum {string}\n */\nexport var PostRelation;\n(function (PostRelation) {\n    PostRelation[\"REPLIES\"] = \"replies\";\n    PostRelation[\"REACTIONS\"] = \"reactions\";\n    PostRelation[\"PARENT\"] = \"parent\";\n    PostRelation[\"CHANNEL\"] = \"channel\";\n})(PostRelation || (PostRelation = {}));\n/**\n * relations of reaction entity\n *\n * @export\n * @enum {string}\n */\nexport var ReactionRelation;\n(function (ReactionRelation) {\n    ReactionRelation[\"POST\"] = \"post\";\n})(ReactionRelation || (ReactionRelation = {}));\n/**\n * filters of channel entity\n *\n * @export\n * @enum {string}\n */\nexport var ChannelFilter;\n(function (ChannelFilter) {\n    ChannelFilter[\"HAS_USER_POSTS\"] = \"has_user_posts\";\n})(ChannelFilter || (ChannelFilter = {}));\n// sorting\n/**\n * Common sorting fields\n */\nexport var CommonSort;\n(function (CommonSort) {\n    CommonSort[\"CREATED_AT\"] = \"createdAt\";\n    CommonSort[\"CREATOR\"] = \"creator\";\n    CommonSort[\"EDITOR\"] = \"editor\";\n    CommonSort[\"ID\"] = \"id\";\n    CommonSort[\"UPDATED_AT\"] = \"updatedAt\";\n})(CommonSort || (CommonSort = {}));\n/**\n * Role types\n *\n * @export\n * @enum {string}\n */\nexport var Role;\n(function (Role) {\n    Role[\"READ\"] = \"read\";\n    Role[\"WRITE\"] = \"write\";\n    Role[\"READWRITE\"] = \"readWrite\";\n    Role[\"MODERATE\"] = \"moderate\";\n    Role[\"MANAGE\"] = \"manage\";\n    Role[\"OWNER\"] = \"owner\";\n})(Role || (Role = {}));\n/**\n * Post sorting fields\n *\n * @enum {string}\n */\nexport var PostSort;\n(function (PostSort) {\n    PostSort[\"BODY\"] = \"body\";\n    PostSort[\"CHANNEL_ID\"] = \"channelId\";\n    PostSort[\"CREATED_AT\"] = \"createdAt\";\n    PostSort[\"CREATOR\"] = \"creator\";\n    PostSort[\"DISCUSSION\"] = \"discussion\";\n    PostSort[\"EDITOR\"] = \"editor\";\n    PostSort[\"ID\"] = \"id\";\n    PostSort[\"PARENT_ID\"] = \"parentId\";\n    PostSort[\"STATUS\"] = \"status\";\n    PostSort[\"TITLE\"] = \"title\";\n    PostSort[\"UPDATED_AT\"] = \"updatedAt\";\n})(PostSort || (PostSort = {}));\n/**\n * Post types\n *\n * @enum{string}\n */\nexport var PostType;\n(function (PostType) {\n    PostType[\"Text\"] = \"text\";\n    PostType[\"Announcement\"] = \"announcement\";\n    PostType[\"Poll\"] = \"poll\";\n    PostType[\"Question\"] = \"question\";\n})(PostType || (PostType = {}));\n/**\n * Channel sorting fields\n *\n * @export\n * @enum {string}\n */\nexport var ChannelSort;\n(function (ChannelSort) {\n    ChannelSort[\"ACCESS\"] = \"access\";\n    ChannelSort[\"CREATED_AT\"] = \"createdAt\";\n    ChannelSort[\"CREATOR\"] = \"creator\";\n    ChannelSort[\"EDITOR\"] = \"editor\";\n    ChannelSort[\"ID\"] = \"id\";\n    ChannelSort[\"LAST_ACTIVITY\"] = \"last_activity\";\n    ChannelSort[\"UPDATED_AT\"] = \"updatedAt\";\n})(ChannelSort || (ChannelSort = {}));\n/**\n * relations of channel entity\n *\n * @export\n * @enum {string}\n */\nexport var ChannelRelation;\n(function (ChannelRelation) {\n    ChannelRelation[\"CHANNEL_ACL\"] = \"channelAcl\";\n})(ChannelRelation || (ChannelRelation = {}));\nexport var AclCategory;\n(function (AclCategory) {\n    AclCategory[\"GROUP\"] = \"group\";\n    AclCategory[\"ORG\"] = \"org\";\n    AclCategory[\"USER\"] = \"user\";\n    AclCategory[\"ANONYMOUS_USER\"] = \"anonymousUser\";\n    AclCategory[\"AUTHENTICATED_USER\"] = \"authenticatedUser\";\n})(AclCategory || (AclCategory = {}));\nexport var AclSubCategory;\n(function (AclSubCategory) {\n    AclSubCategory[\"ADMIN\"] = \"admin\";\n    AclSubCategory[\"MEMBER\"] = \"member\";\n})(AclSubCategory || (AclSubCategory = {}));\n//# sourceMappingURL=types.js.map","import { IChannel, IPost, PostReaction, SharingAccess, createChannel, createPost, createReaction, removePost, searchChannels, searchPosts } from '@esri/hub-discussions';\nimport { createGroup, IGroup, SearchQueryBuilder, searchGroups } from \"@esri/arcgis-rest-portal\";\n\nimport state from './state';\n\nconst hubChatHistoryKeyword = \"hubChatHistory\";\n\nexport async function deleteResponse(postId: string) {\n  return removePost({\n    postId,\n    ...state.context.hubRequestOptions\n  })\n}\n\n\nexport async function addResponseFeedback(postId: string = null, reaction: PostReaction = PostReaction.EYES) {\n  if(!postId) {\n    return null\n  };\n  \n  return createReaction({\n    data: {\n      postId,\n      value: reaction,\n    },\n    ...state.context.hubRequestOptions\n  })\n}\n\nexport async function findOrCreateChatHistoryGroup() {\n  let chatHistoryGroup:IGroup = null;\n\n  // Get the Chat history group, or create one if it doesn't exist yet.\n  const query = new SearchQueryBuilder()\n                .match(hubChatHistoryKeyword)\n                .in(\"typekeywords\");\n  const searchResponse = await searchGroups({\n      q: query,\n      ...state.context.hubRequestOptions\n    },\n  );\n  console.debug(\"Find chat history group\", searchResponse)\n\n  // TODO: catch for potential duplicate 'chat history' groups\n  if(searchResponse.results.length > 0) {\n    chatHistoryGroup = searchResponse.results[0];\n  } else {\n    const createGroupResponse = await createGroup({\n      group: {\n        title: \"Chat History\",\n        access: \"private\",\n        typeKeywords: [hubChatHistoryKeyword]\n      },\n      ...state.context.hubRequestOptions\n    })\n    console.debug(\"Chat History createGroupResponse\", createGroupResponse);\n\n    if(createGroupResponse.success) {\n      chatHistoryGroup = createGroupResponse.group;\n    }\n    \n  }\n  return chatHistoryGroup;  \n}\n\nexport async function createChatHistory(chatHistoryGroup: IGroup) {\n  \n  if(!!chatHistoryGroup) {\n    const channel = await createChannel({ \n      data: {\n        name: \"Chat History\",\n        // num: 1,\n        groups: [chatHistoryGroup.id],\n        access: SharingAccess.PRIVATE,\n      },\n      ...state.context.hubRequestOptions    \n    })\n  \n    return channel;\n  }\n  \n}\n\n// TODO move this to state?\nlet chatHistoryChannel:IChannel = null;\n\nexport async function getChatHistory(): Promise<IPost[]> {\n  chatHistoryChannel = await getChatChannel();\n  const posts = await searchPosts({\n    data: {\n      // num: 1,\n      channels: [chatHistoryChannel.id],\n      // access: [SharingAccess.PRIVATE],\n    },\n    ...state.context.hubRequestOptions    \n  })\n\n\n  return posts.items;\n}\nexport async function addChatHistory(text: string ) {\n\n const post = await createPost({\n  data: {\n\n    channelId: chatHistoryChannel.id,\n    body: text,\n    discussion: 'hub://compass/general'\n  },\n  ...state.context.hubRequestOptions    \n})\n\nreturn post;\n\n}\n\nexport async function getChatChannel() {\n\n  const chatHistoryGroup = await findOrCreateChatHistoryGroup();\n  let chatHistoryChannel:IChannel = null;\n\n  console.debug(\"user\", state.user);\n  const channels = await searchChannels({\n    data: {\n      // num: 1,\n      groups: [chatHistoryGroup.id],\n      // access: [SharingAccess.PRIVATE],\n    },\n    ...state.context.hubRequestOptions\n  })\n\n  console.debug(\"searchChannels\", channels);\n\n  if(channels.items.length > 0) {\n    chatHistoryChannel = channels.items[0];\n  } else {\n    chatHistoryChannel = await createChatHistory(chatHistoryGroup);\n  }\n  console.debug(\"chatHistoryChannel\", chatHistoryChannel);\n\n  return chatHistoryChannel;\n}"],"mappings":"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"}