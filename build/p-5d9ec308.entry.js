import{r as t,h as e}from"./p-5b036533.js";import{H as o,a as s}from"./p-96c6bc09.js";
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.8-next.4
 */const a="calcite-mode-auto";const n="calcite-mode-dark";
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.8-next.4
 */function i(){const{classList:t}=document.body;const e=window.matchMedia("(prefers-color-scheme: dark)").matches;const o=()=>t.contains(n)||t.contains(a)&&e?"dark":"light";const s=t=>document.body.dispatchEvent(new CustomEvent("calciteModeChange",{bubbles:true,detail:{mode:t}}));const i=t=>{r!==t&&s(t);r=t};let r=o();s(r);window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",(t=>i(t.matches?"dark":"light")));new MutationObserver((()=>i(o()))).observe(document.body,{attributes:true,attributeFilter:["class"]})}function r(){const t=typeof window!=="undefined"&&typeof location!=="undefined"&&typeof document!=="undefined"&&window.location===location&&window.document===document;if(t){if(document.readyState==="interactive"){i()}else{document.addEventListener("DOMContentLoaded",(()=>i()),{once:true})}}}const c=r;c();const u={nearby:"https://ajturner-refactored-space-cod-6rr7x76f4gg6-8000.preview.app.github.dev/chat",text:"https://api.openai.com/v1/chat/completions",image:"https://api.openai.com/v1/images/generations"};async function l(t){const e=await fetch(u["nearby"]+"?"+new URLSearchParams({query:t}));const o=await e.text();return o}async function h(t,e="en",o,s){var a,n;const i={en:"gpt-3.5-turbo",es:"curie",fr:"davinci"};const r=i[e]||"gpt-3.5-turbo";const c=await fetch(u["text"],{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({model:r,messages:[{role:"system",content:o},{role:"user",content:t}],temperature:.4})});const l=await c.json();const h=(n=(a=l.choices[0])===null||a===void 0?void 0:a.message)===null||n===void 0?void 0:n.content;return h}async function d(t,e){var o;const s=await fetch(u["image"],{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({prompt:t})});const a=await s.json();const n=(o=a.data[0])===null||o===void 0?void 0:o.url;return n}const p=":host{display:block;position:fixed;bottom:20px;right:20px;z-index:9999}.fab{display:flex;justify-content:center;align-items:center;position:relative;color:white;font-size:28px;cursor:pointer;transition:width 0.3s;width:140px}.fab:hover .fab-icon{background-color:gray;border-color:#0077c2}.fab .fab-icon{width:56px;background-color:#0077c2;width:56px;height:56px;border-radius:50%;box-shadow:0px 4px 10px rgba(0, 0, 0, 0.1)}.tooltip{position:absolute;top:-30px;left:0;right:0;margin:auto;display:none;background-color:rgba(0, 0, 0, 0.8);color:white;padding:4px 8px;border-radius:4px;font-size:12px;text-align:center;pointer-events:none}.fab:hover .tooltip{display:block}.chat-window{position:fixed;bottom:90px;right:20px;width:350px;max-height:80vh;border-radius:10px;background-color:white;box-shadow:0px 4px 10px rgba(0, 0, 0, 0.1);overflow:hidden}.intro{padding:10px;font-size:14px;line-height:1.5}.messages{padding:10px;height:80%;overflow-y:scroll;display:flex;flex-direction:column;gap:1rem}.author-hub{}.loading{display:flex;align-items:center;justify-content:center;height:40px}.dot{display:inline-block;width:8px;height:8px;margin:0 2px;background-color:#0077c2;border-radius:50%;animation:dot-pulse 1.2s infinite ease-in-out}@keyframes dot-pulse{0%{transform:scale(1)}50%{transform:scale(1.3)}100%{transform:scale(1)}}.example-prompts{display:flex;justify-content:center;padding:10px}.example-prompts button{margin:0 5px;padding:8px 16px;border:none;border-radius:20px;background-color:#0077c2;color:white;font-size:14px;cursor:pointer}.example-prompts button:focus{outline:none}.example-prompts button:active{background-color:#005da8}.language-buttons{display:flex;justify-content:center;margin-top:10px}.language-buttons button{margin:0 5px;padding:5px 10px;border:none;border-radius:20px;background-color:#0077c2;color:white;font-size:14px;cursor:pointer}.language-buttons button:focus{outline:none}.language-buttons button:active{background-color:#005da8}";const b=class{constructor(e){t(this,e);this.apikey="";this.model=o.Nearby;this.personality="You are writing for a government websites readable by 8th graders.";this.chatOpen=false;this.welcome=null;this.language="en";this.messages=[];this.loading=false}componentWillLoad(){if(!!this.welcome){this.messages.push({author:"AI",text:this.welcome})}}toggleChat(){this.chatOpen=!this.chatOpen}async sendMessage(t){const e=t.detail;this.messages=[...this.messages,e];this.loading=true;let a="";console.debug("calling model",[this.model,e]);switch(this.model){case o.Nearby:a=await l(e.text);break;case o.Text:a=await h(e.text,this.language,this.personality,this.apikey);break;case o.Image:a=await d(e.text,this.apikey);break}this.messages=[...this.messages,{author:s.hub,text:a}];this.loading=false}render(){return e("div",null,this.chatOpen?e("div",{class:"chat-window"},e("div",{class:"messages"},this.renderIntro(),e("hub-chat-response",{class:`message author-user`,message:{author:"user",text:"thank you!"}}),e("hub-chat-response",{class:`message author-hub`,message:{author:"hub",text:"welcome"}}),e("hub-chat-response",{class:`message author-user`,message:{author:"user",text:"thank you!"}}),e("hub-chat-response",{class:`message author-user`,message:{author:"user",text:"thank you!"}}),this.messages.map((t=>e("hub-chat-response",{class:`message author-${t.author}`,message:t}))),this.loading?this.renderLoading():null),e("hub-chat-input",null)):null,e("div",{class:"fab",onClick:()=>this.toggleChat()},e("span",{class:"tooltip"},"Open Hub Compass"),e("calcite-icon",{class:"fab-icon",icon:"explore","text-label":"Open Hub Compass"})))}renderLoading(){return e("div",{class:"loading"},e("div",{class:"dot"}),e("div",{class:"dot"}),e("div",{class:"dot"}))}renderIntro(){return[e("hub-chat-response",{class:`message author-hub`,message:{author:"hub",text:"Welcome to the Hub Compass Chatbot!"}}),e("hub-chat-response",{class:`message author-hub`,message:{author:"hub",text:"How can I assist you today?"}})]}};b.style=p;export{b as hub_aibot};
//# sourceMappingURL=p-5d9ec308.entry.js.map