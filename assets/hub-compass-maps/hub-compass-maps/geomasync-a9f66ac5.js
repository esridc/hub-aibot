import { fC as a, bN as j, eJ as p, ca as H, dl as m, cs as M, a9 as x$1, dk as u, bW as p$2, c1 as j$2 } from './hub-compass-map-68308039.js';
import { Q, l as s, m as e$1, v, t as Ne, B, o as oe, z, q, y as ye, u as c, V, w as r, x as ke, H as a$1, I as je, K as Ae, f as fe, M as me, P as l, S as u$1, U as t$1, A as A$1, X as Pe } from './arcadeUtils-f09b2b56.js';
import { F, A, h, S, m as m$1, x, p as p$1, O, g, R, D, b, E, k, y, w, W, K, M as M$1, d, C, U, B as B$1, L, P, v as v$1, H as H$1, N, J, j as j$1, T, V as V$1 } from './geometryEngineAsync-e7d1874f.js';
import { t, e } from './executionError-5ec41157.js';
import { t as t$2, s as s$1 } from './portalUtils-fc670961.js';
import './index-d436d5f8.js';
import './arcadeTimeUtils-f8caff3d.js';
import './number-edc7ee48.js';
import './featureConversionUtils-e451106b.js';
import './OptimizedGeometry-d99be84d.js';
import './OptimizedFeatureSet-c30cfe93.js';

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
function pn(t){return 0===a.indexOf("4.")?j.fromExtent(t):new j({spatialReference:t.spatialReference,rings:[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]})}function gn(n,t$1,e$1){if(Q(n,2,2,t$1,e$1),n[0]instanceof p&&n[1]instanceof p);else if(n[0]instanceof p&&null===n[1]);else if(n[1]instanceof p&&null===n[0]);else if(null!==n[0]||null!==n[1])throw new t(t$1,e.InvalidParameter,e$1)}async function vn(n,t){if("polygon"!==n.type&&"polyline"!==n.type&&"extent"!==n.type)return 0;let e=1;if(n.spatialReference.vcsWkid||n.spatialReference.latestVcsWkid){e=s(n.spatialReference)/H(n.spatialReference);}let r=0;if("polyline"===n.type)for(const a of n.paths)for(let n=1;n<a.length;n++)r+=e$1(a[n],a[n-1],e);else if("polygon"===n.type)for(const a of n.rings){for(let n=1;n<a.length;n++)r+=e$1(a[n],a[n-1],e);(a[0][0]!==a[a.length-1][0]||a[0][1]!==a[a.length-1][1]||void 0!==a[0][2]&&a[0][2]!==a[a.length-1][2])&&(r+=e$1(a[0],a[a.length-1],e));}else "extent"===n.type&&(r+=2*e$1([n.xmin,n.ymin,0],[n.xmax,n.ymin,0],e),r+=2*e$1([n.xmin,n.ymin,0],[n.xmin,n.ymax,0],e),r*=2,r+=4*Math.abs(v(n.zmax,0)*e-v(n.zmin,0)*e));const i=new m({hasZ:!1,hasM:!1,spatialReference:n.spatialReference,paths:[[0,0],[0,r]]});return F(i,t)}function Pn(n){"async"===n.mode&&(n.functions.disjoint=function(t,e){return n.standardFunctionAsync(t,e,((n,r,a)=>(gn(a=Ne(a),t,e),null===a[0]||null===a[1]||A(a[0],a[1]))))},n.functions.intersects=function(t,e){return n.standardFunctionAsync(t,e,((n,r,a)=>(gn(a=Ne(a),t,e),null!==a[0]&&null!==a[1]&&h(a[0],a[1]))))},n.functions.touches=function(t,e){return n.standardFunctionAsync(t,e,((n,r,a)=>(gn(a=Ne(a),t,e),null!==a[0]&&null!==a[1]&&S(a[0],a[1]))))},n.functions.crosses=function(t,e){return n.standardFunctionAsync(t,e,((n,r,a)=>(gn(a=Ne(a),t,e),null!==a[0]&&null!==a[1]&&m$1(a[0],a[1]))))},n.functions.within=function(t,e){return n.standardFunctionAsync(t,e,((n,r,a)=>(gn(a=Ne(a),t,e),null!==a[0]&&null!==a[1]&&x(a[0],a[1]))))},n.functions.contains=function(t,e){return n.standardFunctionAsync(t,e,((n,r,a)=>(gn(a=Ne(a),t,e),null!==a[0]&&null!==a[1]&&p$1(a[0],a[1]))))},n.functions.overlaps=function(t,e){return n.standardFunctionAsync(t,e,((n,r,a)=>(gn(a=Ne(a),t,e),null!==a[0]&&null!==a[1]&&O(a[0],a[1]))))},n.functions.equals=function(t,e){return n.standardFunctionAsync(t,e,((n,r,i)=>(Q(i,2,2,t,e),i[0]===i[1]||(i[0]instanceof p&&i[1]instanceof p?g(i[0],i[1]):!(!B(i[0])||!B(i[1]))&&i[0].equals(i[1])))))},n.functions.relate=function(t$1,e$1){return n.standardFunctionAsync(t$1,e$1,((n,r,o)=>{if(o=Ne(o),Q(o,3,3,t$1,e$1),o[0]instanceof p&&o[1]instanceof p)return R(o[0],o[1],oe(o[2]));if(o[0]instanceof p&&null===o[1])return !1;if(o[1]instanceof p&&null===o[0])return !1;if(null===o[0]&&null===o[1])return !1;throw new t(t$1,e.InvalidParameter,e$1)}))},n.functions.intersection=function(t,e){return n.standardFunctionAsync(t,e,((n,r,a)=>(gn(a=Ne(a),t,e),null===a[0]||null===a[1]?null:D(a[0],a[1]))))},n.functions.union=function(e$1,r){return n.standardFunctionAsync(e$1,r,((n,a,o)=>{const l=[];if(0===(o=Ne(o)).length)throw new t(e$1,e.WrongNumberOfParameters,r);if(1===o.length)if(z(o[0])){const n=Ne(o[0]);for(let t$1=0;t$1<n.length;t$1++)if(null!==n[t$1]){if(!(n[t$1]instanceof p))throw new t(e$1,e.InvalidParameter,r);l.push(n[t$1]);}}else {if(!q(o[0])){if(o[0]instanceof p)return ye(c(o[0]),e$1.spatialReference);if(null===o[0])return null;throw new t(e$1,e.InvalidParameter,r)}{const n=Ne(o[0].toArray());for(let t$1=0;t$1<n.length;t$1++)if(null!==n[t$1]){if(!(n[t$1]instanceof p))throw new t(e$1,e.InvalidParameter,r);l.push(n[t$1]);}}}else for(let t$1=0;t$1<o.length;t$1++)if(null!==o[t$1]){if(!(o[t$1]instanceof p))throw new t(e$1,e.InvalidParameter,r);l.push(o[t$1]);}return 0===l.length?null:b(l)}))},n.functions.difference=function(e,r){return n.standardFunctionAsync(e,r,((n,a,o)=>(gn(o=Ne(o),e,r),null!==o[0]&&null===o[1]?c(o[0]):null===o[0]?null:E(o[0],o[1]))))},n.functions.symmetricdifference=function(e,r){return n.standardFunctionAsync(e,r,((n,a,o)=>(gn(o=Ne(o),e,r),null===o[0]&&null===o[1]?null:null===o[0]?c(o[1]):null===o[1]?c(o[0]):k(o[0],o[1]))))},n.functions.clip=function(t$1,e$1){return n.standardFunctionAsync(t$1,e$1,((n,r,o)=>{if(o=Ne(o),Q(o,2,2,t$1,e$1),!(o[1]instanceof M)&&null!==o[1])throw new t(t$1,e.InvalidParameter,e$1);if(null===o[0])return null;if(!(o[0]instanceof p))throw new t(t$1,e.InvalidParameter,e$1);return null===o[1]?null:y(o[0],o[1])}))},n.functions.cut=function(e$1,r){return n.standardFunctionAsync(e$1,r,((n,o,l)=>{if(l=Ne(l),Q(l,2,2,e$1,r),!(l[1]instanceof m)&&null!==l[1])throw new t(e$1,e.InvalidParameter,r);if(null===l[0])return [];if(!(l[0]instanceof p))throw new t(e$1,e.InvalidParameter,r);return null===l[1]?[c(l[0])]:w(l[0],l[1])}))},n.functions.area=function(t$1,r$1){return n.standardFunctionAsync(t$1,r$1,(async(n,o,l)=>{if(Q(l,1,2,t$1,r$1),null===(l=Ne(l))[0])return 0;if(V(l[0])){const n=await l[0].sumArea(r(v(l[1],-1)),!1,t$1.abortSignal);if(t$1.abortSignal.aborted)throw new t(t$1,e.Cancelled,r$1);return n}if(z(l[0])||q(l[0])){const n=ke(l[0],t$1.spatialReference);return null===n?0:W(n,r(v(l[1],-1)))}if(!(l[0]instanceof p))throw new t(t$1,e.InvalidParameter,r$1);return W(l[0],r(v(l[1],-1)))}))},n.functions.areageodetic=function(t$1,r$1){return n.standardFunctionAsync(t$1,r$1,(async(n,o,l)=>{if(Q(l,1,2,t$1,r$1),null===(l=Ne(l))[0])return 0;if(V(l[0])){const n=await l[0].sumArea(r(v(l[1],-1)),!0,t$1.abortSignal);if(t$1.abortSignal.aborted)throw new t(t$1,e.Cancelled,r$1);return n}if(z(l[0])||q(l[0])){const n=ke(l[0],t$1.spatialReference);return null===n?0:K(n,r(v(l[1],-1)))}if(!(l[0]instanceof p))throw new t(t$1,e.InvalidParameter,r$1);return K(l[0],r(v(l[1],-1)))}))},n.functions.length=function(t$1,e$1){return n.standardFunctionAsync(t$1,e$1,(async(n,o,l)=>{if(Q(l,1,2,t$1,e$1),null===(l=Ne(l))[0])return 0;if(V(l[0])){const n=await l[0].sumLength(a$1(v(l[1],-1)),!1,t$1.abortSignal);if(t$1.abortSignal.aborted)throw new t(t$1,e.Cancelled,e$1);return n}if(z(l[0])||q(l[0])){const n=je(l[0],t$1.spatialReference);return null===n?0:F(n,a$1(v(l[1],-1)))}if(!(l[0]instanceof p))throw new t(t$1,e.InvalidParameter,e$1);return F(l[0],a$1(v(l[1],-1)))}))},n.functions.length3d=function(t$1,e$1){return n.standardFunctionAsync(t$1,e$1,((n,o,l)=>{if(Q(l,1,2,t$1,e$1),null===(l=Ne(l))[0])return 0;if(z(l[0])||q(l[0])){const n=je(l[0],t$1.spatialReference);return null===n?0:!0===n.hasZ?vn(n,a$1(v(l[1],-1))):F(n,a$1(v(l[1],-1)))}if(!(l[0]instanceof p))throw new t(t$1,e.InvalidParameter,e$1);return !0===l[0].hasZ?vn(l[0],a$1(v(l[1],-1))):F(l[0],a$1(v(l[1],-1)))}))},n.functions.lengthgeodetic=function(t$1,e$1){return n.standardFunctionAsync(t$1,e$1,(async(n,o,l)=>{if(Q(l,1,2,t$1,e$1),null===(l=Ne(l))[0])return 0;if(V(l[0])){const n=await l[0].sumLength(a$1(v(l[1],-1)),!0,t$1.abortSignal);if(t$1.abortSignal.aborted)throw new t(t$1,e.Cancelled,e$1);return n}if(z(l[0])||q(l[0])){const n=je(l[0],t$1.spatialReference);return null===n?0:M$1(n,a$1(v(l[1],-1)))}if(!(l[0]instanceof p))throw new t(t$1,e.InvalidParameter,e$1);return M$1(l[0],a$1(v(l[1],-1)))}))},n.functions.distance=function(t$1,e$1){return n.standardFunctionAsync(t$1,e$1,((n,o,l)=>{l=Ne(l),Q(l,2,3,t$1,e$1);let c=l[0];(z(l[0])||q(l[0]))&&(c=Ae(l[0],t$1.spatialReference));let f=l[1];if((z(l[1])||q(l[1]))&&(f=Ae(l[1],t$1.spatialReference)),!(c instanceof p))throw new t(t$1,e.InvalidParameter,e$1);if(!(f instanceof p))throw new t(t$1,e.InvalidParameter,e$1);return d(c,f,a$1(v(l[2],-1)))}))},n.functions.distancegeodetic=function(t$1,e$1){return n.standardFunctionAsync(t$1,e$1,((n,o,l)=>{l=Ne(l),Q(l,2,3,t$1,e$1);const s=l[0],u=l[1];if(!(s instanceof x$1))throw new t(t$1,e.InvalidParameter,e$1);if(!(u instanceof x$1))throw new t(t$1,e.InvalidParameter,e$1);const c=new m({paths:[],spatialReference:s.spatialReference});return c.addPath([s,u]),M$1(c,a$1(v(l[2],-1)))}))},n.functions.densify=function(t$1,e$1){return n.standardFunctionAsync(t$1,e$1,((n,o,l)=>{if(l=Ne(l),Q(l,2,3,t$1,e$1),null===l[0])return null;if(!(l[0]instanceof p))throw new t(t$1,e.InvalidParameter,e$1);const s=fe(l[1]);if(isNaN(s))throw new t(t$1,e.InvalidParameter,e$1);if(s<=0)throw new t(t$1,e.InvalidParameter,e$1);return l[0]instanceof j||l[0]instanceof m?C(l[0],s,a$1(v(l[2],-1))):l[0]instanceof M?C(pn(l[0]),s,a$1(v(l[2],-1))):l[0]}))},n.functions.densifygeodetic=function(t$1,e$1){return n.standardFunctionAsync(t$1,e$1,((n,o,l)=>{if(l=Ne(l),Q(l,2,3,t$1,e$1),null===l[0])return null;if(!(l[0]instanceof p))throw new t(t$1,e.InvalidParameter,e$1);const s=fe(l[1]);if(isNaN(s))throw new t(t$1,e.InvalidParameter,e$1);if(s<=0)throw new t(t$1,e.InvalidParameter,e$1);return l[0]instanceof j||l[0]instanceof m?U(l[0],s,a$1(v(l[2],-1))):l[0]instanceof M?U(pn(l[0]),s,a$1(v(l[2],-1))):l[0]}))},n.functions.generalize=function(t$1,e$1){return n.standardFunctionAsync(t$1,e$1,((n,o,l)=>{if(l=Ne(l),Q(l,2,4,t$1,e$1),null===l[0])return null;if(!(l[0]instanceof p))throw new t(t$1,e.InvalidParameter,e$1);const s=fe(l[1]);if(isNaN(s))throw new t(t$1,e.InvalidParameter,e$1);return B$1(l[0],s,me(v(l[2],!0)),a$1(v(l[3],-1)))}))},n.functions.buffer=function(e$1,o){return n.standardFunctionAsync(e$1,o,((n,l,s)=>{if(s=Ne(s),Q(s,2,3,e$1,o),null===s[0])return null;if(!(s[0]instanceof p))throw new t(e$1,e.InvalidParameter,o);const u=fe(s[1]);if(isNaN(u))throw new t(e$1,e.InvalidParameter,o);return 0===u?c(s[0]):L(s[0],u,a$1(v(s[2],-1)))}))},n.functions.buffergeodetic=function(e$1,o){return n.standardFunctionAsync(e$1,o,((n,l,s)=>{if(s=Ne(s),Q(s,2,3,e$1,o),null===s[0])return null;if(!(s[0]instanceof p))throw new t(e$1,e.InvalidParameter,o);const u=fe(s[1]);if(isNaN(u))throw new t(e$1,e.InvalidParameter,o);return 0===u?c(s[0]):P(s[0],u,a$1(v(s[2],-1)))}))},n.functions.offset=function(t$1,e$1){return n.standardFunctionAsync(t$1,e$1,((n,o,s)=>{if(s=Ne(s),Q(s,2,6,t$1,e$1),null===s[0])return null;if(!(s[0]instanceof j||s[0]instanceof m))throw new t(t$1,e.InvalidParameter,e$1);const u=fe(s[1]);if(isNaN(u))throw new t(t$1,e.InvalidParameter,e$1);const c=fe(v(s[4],10));if(isNaN(c))throw new t(t$1,e.InvalidParameter,e$1);const f=fe(v(s[5],0));if(isNaN(f))throw new t(t$1,e.InvalidParameter,e$1);return v$1(s[0],u,a$1(v(s[2],-1)),oe(v(s[3],"round")).toLowerCase(),c,f)}))},n.functions.rotate=function(t$1,e$1){return n.standardFunctionAsync(t$1,e$1,((n,r,o)=>{o=Ne(o),Q(o,2,3,t$1,e$1);let l=o[0];if(null===l)return null;if(!(l instanceof p))throw new t(t$1,e.InvalidParameter,e$1);l instanceof M&&(l=j.fromExtent(l));const s=fe(o[1]);if(isNaN(s))throw new t(t$1,e.InvalidParameter,e$1);const u=v(o[2],null);if(null===u)return H$1(l,s);if(u instanceof x$1)return H$1(l,s,u);throw new t(t$1,e.InvalidParameter,e$1)}))},n.functions.centroid=function(e$1,r){return n.standardFunctionAsync(e$1,r,((n,o,l$1)=>{if(l$1=Ne(l$1),Q(l$1,1,1,e$1,r),null===l$1[0])return null;let f=l$1[0];if((z(l$1[0])||q(l$1[0]))&&(f=Ae(l$1[0],e$1.spatialReference)),null===f)return null;if(!(f instanceof p))throw new t(e$1,e.InvalidParameter,r);return f instanceof x$1?ye(c(l$1[0]),e$1.spatialReference):f instanceof j?f.centroid:f instanceof m?l(f):f instanceof u?u$1(f):f instanceof M?f.center:null}))},n.functions.multiparttosinglepart=function(e$1,r){return n.standardFunctionAsync(e$1,r,(async(n,o,l)=>{l=Ne(l),Q(l,1,1,e$1,r);const s=[];if(null===l[0])return null;if(!(l[0]instanceof p))throw new t(e$1,e.InvalidParameter,r);if(l[0]instanceof x$1)return [ye(c(l[0]),e$1.spatialReference)];if(l[0]instanceof M)return [ye(c(l[0]),e$1.spatialReference)];const u$1=await N(l[0]);if(u$1 instanceof j){const n=[],t=[];for(let e=0;e<u$1.rings.length;e++)if(u$1.isClockwise(u$1.rings[e])){const t=p$2({rings:[u$1.rings[e]],hasZ:!0===u$1.hasZ,hazM:!0===u$1.hasM,spatialReference:u$1.spatialReference.toJSON()});n.push(t);}else t.push({ring:u$1.rings[e],pt:u$1.getPoint(e,0)});for(let e=0;e<t.length;e++)for(let r=0;r<n.length;r++)if(n[r].contains(t[e].pt)){n[r].addRing(t[e].ring);break}return n}if(u$1 instanceof m){const n=[];for(let t=0;t<u$1.paths.length;t++){const e=p$2({paths:[u$1.paths[t]],hasZ:!0===u$1.hasZ,hazM:!0===u$1.hasM,spatialReference:u$1.spatialReference.toJSON()});n.push(e);}return n}if(l[0]instanceof u){const n=ye(c(l[0]),e$1.spatialReference);for(let t=0;t<n.points.length;t++)s.push(n.getPoint(t));return s}return null}))},n.functions.issimple=function(t$1,e$1){return n.standardFunctionAsync(t$1,e$1,((n,r,o)=>{if(o=Ne(o),Q(o,1,1,t$1,e$1),null===o[0])return !0;if(!(o[0]instanceof p))throw new t(t$1,e.InvalidParameter,e$1);return J(o[0])}))},n.functions.simplify=function(t$1,e$1){return n.standardFunctionAsync(t$1,e$1,((n,r,o)=>{if(o=Ne(o),Q(o,1,1,t$1,e$1),null===o[0])return null;if(!(o[0]instanceof p))throw new t(t$1,e.InvalidParameter,e$1);return N(o[0])}))},n.functions.convexhull=function(t$1,e$1){return n.standardFunctionAsync(t$1,e$1,((n,r,o)=>{if(o=Ne(o),Q(o,1,1,t$1,e$1),null===o[0])return null;if(!(o[0]instanceof p))throw new t(t$1,e.InvalidParameter,e$1);return j$1(o[0])}))},n.functions.getuser=function(t$3,e$1){return n.standardFunctionAsync(t$3,e$1,(async(n,r,i)=>{Q(i,0,2,t$3,e$1);let o=v(i[1],""),s=!0===o;if(o=!0===o||!1===o?"":oe(o),0===i.length||i[0]instanceof t$1){let n=null;n=t$3.services&&t$3.services.portal?t$3.services.portal:j$2.getDefault(),i.length>0&&(n=t$2(i[0],n));const e=await s$1(n,o,s);if(e){const n=JSON.parse(JSON.stringify(e));for(const t of ["lastLogin","created","modified"])void 0!==n[t]&&null!==n[t]&&(n[t]=new Date(n[t]));return A$1.convertObjectToArcadeDictionary(n,Pe(t$3))}return null}let u=null;if(V(i[0])&&(u=i[0]),u){if(s=!1,o)return null;await u.load();const n=await u.getOwningSystemUrl();if(!n){if(!o){const n=await u.getIdentityUser();return n?A$1.convertObjectToArcadeDictionary({username:n},Pe(t$3)):null}return null}let e=null;e=t$3.services&&t$3.services.portal?t$3.services.portal:j$2.getDefault(),e=t$2(new t$1(n),e);const r=await s$1(e,o,s);if(r){const n=JSON.parse(JSON.stringify(r));for(const t of ["lastLogin","created","modified"])void 0!==n[t]&&null!==n[t]&&(n[t]=new Date(n[t]));return A$1.convertObjectToArcadeDictionary(n,Pe(t$3))}return null}throw new t(t$3,e.InvalidParameter,e$1)}))}),n.functions.nearestcoordinate=function(t$1,e$1){return n.standardFunctionAsync(t$1,e$1,(async(n,r,o)=>{if(o=Ne(o),Q(o,2,2,t$1,e$1),!(o[0]instanceof p||null===o[0]))throw new t(t$1,e.InvalidParameter,e$1);if(!(o[1]instanceof x$1||null===o[1]))throw new t(t$1,e.InvalidParameter,e$1);if(null===o[0]||null===o[1])return null;const l=await T(o[0],o[1]);return null===l?null:A$1.convertObjectToArcadeDictionary({coordinate:l.coordinate,distance:l.distance},Pe(t$1),!1,!0)}))},n.functions.nearestvertex=function(t$1,e$1){return n.standardFunctionAsync(t$1,e$1,(async(n,r,o)=>{if(o=Ne(o),Q(o,2,2,t$1,e$1),!(o[0]instanceof p||null===o[0]))throw new t(t$1,e.InvalidParameter,e$1);if(!(o[1]instanceof x$1||null===o[1]))throw new t(t$1,e.InvalidParameter,e$1);if(null===o[0]||null===o[1])return null;const l=await V$1(o[0],o[1]);return null===l?null:A$1.convertObjectToArcadeDictionary({coordinate:l.coordinate,distance:l.distance},Pe(t$1),!1,!0)}))};}

export { Pn as registerFunctions };

//# sourceMappingURL=geomasync-a9f66ac5.js.map