import { cV as l$4, iL as c$6, iM as r, eO as v$2, a1 as e$1, a2 as y$6, iN as p$8, eS as r$1, eR as o, a3 as a$3, cU as i$2, aX as h$6, s, aQ as a$4, dK as s$1, gF as h$7, cs as M$3, iO as In, hd as e$4, hf as u$8, l as n$2, cS as p$9, j as s$2, a9 as x$3, iP as G, cj as Ut, f as s$3, ig as P$2, bI as a$6, S as c$7, iQ as l$5, cL as V, hB as zn, hC as a$7, fO as S$2, he as z$1, q as o$3, hE as f$5, iB as g$7, ht as O$1, a7 as g$8, $ as a$8, co as _$1, eN as m$9, eJ as p$b, J as l$6, bN as j$4, cR as d$7, aE as f$6, cB as h$b, ad as r$3, iK as e$7, dY as r$4 } from './hub-compass-map-f4225e12.js';
import { I as I$2, o as o$1, r as r$2, D as D$3, O, h as h$9, _, R as R$2, E as E$2, j as j$3, v as v$3, q, N as N$1, g as g$6, a as h$a, x as x$4, w as w$4, l as l$7 } from './georeference-cff4e5a4.js';
import { m as m$7 } from './MeshGeoreferencedRelativeVertexSpace-8823d711.js';
import { a as a$5, e as e$3, t as t$1, p as p$a, m as m$8 } from './MeshLocalVertexSpace-8e20645b.js';
import { i as i$3 } from './earcut-bde06d16.js';
import { t } from './Indices-051f6bec.js';
import { e as e$2 } from './deduplicate-2cad0874.js';
import { o as o$2, h as h$8, m as m$6, i as i$4, a as a$9 } from './External-818c40d3.js';
import { e as e$6 } from './mat3f64-9c2c37f3.js';
import { e as e$5 } from './mat4f64-f2ca62fb.js';
import { c as c$8 } from './spatialReferenceEllipsoidUtils-f57e674a.js';

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
var p$7;const h$5=new WeakMap;let d$6=0,u$7=p$7=class extends l$4{constructor(t){super(t),this.wrap="repeat";}get url(){return this._get("url")||null}set url(t){this._set("url",t),t&&this._set("data",null);}get data(){return this._get("data")||null}set data(t){this._set("data",t),t&&this._set("url",null);}writeData(t,e,a,r){if(t instanceof HTMLImageElement){const s={type:"image-element",src:c$6(t.src,r),crossOrigin:t.crossOrigin};e[a]=s;}else if(t instanceof HTMLCanvasElement){const r=t.getContext("2d").getImageData(0,0,t.width,t.height),s={type:"canvas-element",imageData:this._encodeImageData(r)};e[a]=s;}else if(t instanceof HTMLVideoElement){const s={type:"video-element",src:c$6(t.src,r),autoplay:t.autoplay,loop:t.loop,muted:t.muted,crossOrigin:t.crossOrigin,preload:t.preload};e[a]=s;}else if(t instanceof ImageData){const r={type:"image-data",imageData:this._encodeImageData(t)};e[a]=r;}}readData(t){switch(t.type){case"image-element":{const e=new Image;return e.src=t.src,e.crossOrigin=t.crossOrigin,e}case"canvas-element":{const e=this._decodeImageData(t.imageData),a=document.createElement("canvas");return a.width=e.width,a.height=e.height,a.getContext("2d").putImageData(e,0,0),a}case"image-data":return this._decodeImageData(t.imageData);case"video-element":{const e=document.createElement("video");return e.src=t.src,e.crossOrigin=t.crossOrigin,e.autoplay=t.autoplay,e.loop=t.loop,e.muted=t.muted,e.preload=t.preload,e}default:return}}get transparent(){const t=this.data,e=this.url;if(t instanceof HTMLCanvasElement)return this._imageDataContainsTransparent(t.getContext("2d").getImageData(0,0,t.width,t.height));if(t instanceof ImageData)return this._imageDataContainsTransparent(t);if(e){const t=e.substr(e.length-4,4).toLowerCase(),a=e.substr(0,15).toLocaleLowerCase();if(".png"===t||"data:image/png;"===a)return !0}return !1}set transparent(t){this._overrideIfSome("transparent",t);}get contentHash(){const t="string"==typeof this.wrap?this.wrap:"object"==typeof this.wrap?`${this.wrap.horizontal}/${this.wrap.vertical}`:"",e=(e="")=>`d:${e},t:${this.transparent},w:${t}`;return null!=this.url?e(this.url):null!=this.data?this.data instanceof HTMLImageElement||this.data instanceof HTMLVideoElement?e(this.data.src):(h$5.has(this.data)||h$5.set(this.data,++d$6),e(h$5.get(this.data))):e()}get memoryUsage(){let t=0;if(t+=null!=this.url?this.url.length:0,null!=this.data){const e=this.data;"data"in e?t+=e.data.byteLength:e instanceof HTMLImageElement?t+=e.naturalWidth*e.naturalHeight*3:e instanceof HTMLCanvasElement&&(t+=e.width*e.height*3);}return t}clone(){const t={url:this.url,data:this.data,wrap:this._cloneWrap()};return new p$7(t)}cloneWithDeduplication(t){const e=t.get(this);if(e)return e;const a=this.clone();return t.set(this,a),a}_cloneWrap(){return "string"==typeof this.wrap?this.wrap:{horizontal:this.wrap.horizontal,vertical:this.wrap.vertical}}_encodeImageData(t){let e="";for(let a=0;a<t.data.length;a++)e+=String.fromCharCode(t.data[a]);return {data:btoa(e),width:t.width,height:t.height}}_decodeImageData(t){const a=atob(t.data),r$1=new Uint8ClampedArray(a.length);for(let e=0;e<a.length;e++)r$1[e]=a.charCodeAt(e);return r(r$1,t.width,t.height)}_imageDataContainsTransparent(t){for(let e=3;e<t.data.length;e+=4)if(255!==t.data[e])return !0;return !1}static from(t){return "string"==typeof t?new p$7({url:t}):t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof ImageData||t instanceof HTMLVideoElement?new p$7({data:t}):v$2(p$7,t)}};e$1([y$6({type:String,json:{write:p$8}})],u$7.prototype,"url",null),e$1([y$6({json:{write:{overridePolicy(){return {enabled:!this.url}}}}}),y$6()],u$7.prototype,"data",null),e$1([r$1("data")],u$7.prototype,"writeData",null),e$1([o("data")],u$7.prototype,"readData",null),e$1([y$6({type:Boolean,json:{write:{overridePolicy(){return {enabled:this._isOverridden("transparent")}}}}})],u$7.prototype,"transparent",null),e$1([y$6({json:{write:!0}})],u$7.prototype,"wrap",void 0),e$1([y$6({readOnly:!0})],u$7.prototype,"contentHash",null),u$7=p$7=e$1([a$3("esri.geometry.support.MeshTexture")],u$7);const m$5=u$7;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
let p$6=class extends(i$2(l$4)){constructor(o){super(o),this.offset=[0,0],this.rotation=0,this.scale=[1,1];}};e$1([y$6({type:[Number],nonNullable:!0,json:{write:!0}})],p$6.prototype,"offset",void 0),e$1([y$6({type:Number,nonNullable:!0,json:{write:!0}})],p$6.prototype,"rotation",void 0),e$1([y$6({type:[Number],nonNullable:!0,json:{write:!0}})],p$6.prototype,"scale",void 0),p$6=e$1([a$3("esri.geometry.support.MeshTextureTransform")],p$6);const c$5=p$6;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
var n$1;let u$6=n$1=class extends l$4{constructor(o){super(o),this.color=null,this.colorTexture=null,this.colorTextureTransform=null,this.normalTexture=void 0,this.normalTextureTransform=void 0,this.alphaMode="auto",this.alphaCutoff=.5,this.doubleSided=!0;}clone(){return this.cloneWithDeduplication(null,new Map)}cloneWithDeduplication(o,r){const e=null!=o?o.get(this):null;if(e)return e;const t=new n$1(this.clonePropertiesWithDeduplication(r));return null!=o&&o.set(this,t),t}clonePropertiesWithDeduplication(o){return {color:null!=this.color?this.color.clone():null,colorTexture:this.colorTexture?.cloneWithDeduplication(o),normalTexture:this.normalTexture?.cloneWithDeduplication(o),alphaMode:this.alphaMode,alphaCutoff:this.alphaCutoff,doubleSided:this.doubleSided,colorTextureTransform:this.colorTextureTransform?.clone(),normalTextureTransform:this.normalTextureTransform?.clone()}}get memoryUsage(){return this.getMemoryUsage()}getMemoryUsage(){let o=0;return o+=null!=this.color?16:0,null!=this.colorTexture&&(o+=this.colorTexture.memoryUsage),o+=null!=this.colorTextureTransform?20:0,null!=this.normalTexture&&(o+=this.normalTexture.memoryUsage),o+=null!=this.normalTextureTransform?20:0,o}};e$1([y$6({type:h$6,json:{write:!0}})],u$6.prototype,"color",void 0),e$1([y$6({type:m$5,json:{write:!0}})],u$6.prototype,"colorTexture",void 0),e$1([y$6({type:c$5,json:{write:!0}})],u$6.prototype,"colorTextureTransform",void 0),e$1([y$6({type:m$5,json:{write:!0}})],u$6.prototype,"normalTexture",void 0),e$1([y$6({type:c$5,json:{write:!0}})],u$6.prototype,"normalTextureTransform",void 0),e$1([y$6({nonNullable:!0,json:{write:!0}})],u$6.prototype,"alphaMode",void 0),e$1([y$6({nonNullable:!0,json:{write:!0}})],u$6.prototype,"alphaCutoff",void 0),e$1([y$6({nonNullable:!0,json:{write:!0}})],u$6.prototype,"doubleSided",void 0),u$6=n$1=e$1([a$3("esri.geometry.support.MeshMaterial")],u$6);const a$2=u$6;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
var n;let u$5=n=class extends a$2{constructor(e){super(e),this.emissiveColor=null,this.emissiveTexture=null,this.emissiveTextureTransform=void 0,this.occlusionTexture=null,this.occlusionTextureTransform=void 0,this.metallic=1,this.roughness=1,this.metallicRoughnessTexture=null,this.metallicRoughnessTextureTransform=void 0;}clone(){return this.cloneWithDeduplication(null,new Map)}cloneWithDeduplication(e,s){const t=null!=e?e.get(this):null;if(t)return t;const o=new n(this.clonePropertiesWithDeduplication(s));return null!=e&&e.set(this,o),o}getMemoryUsage(){let e=super.getMemoryUsage();return e+=null!=this.emissiveColor?16:0,null!=this.emissiveTexture&&(e+=this.emissiveTexture.memoryUsage),e+=null!=this.emissiveTextureTransform?20:0,null!=this.occlusionTexture&&(e+=this.occlusionTexture.memoryUsage),e+=null!=this.occlusionTextureTransform?20:0,null!=this.metallicRoughnessTexture&&(e+=this.metallicRoughnessTexture.memoryUsage),e+=null!=this.metallicRoughnessTextureTransform?20:0,e}clonePropertiesWithDeduplication(e){return {...super.clonePropertiesWithDeduplication(e),emissiveColor:this.emissiveColor?.clone(),emissiveTexture:this.emissiveTexture?.cloneWithDeduplication(e),emissiveTextureTransform:this.emissiveTextureTransform?.clone(),occlusionTexture:this.occlusionTexture?.cloneWithDeduplication(e),occlusionTextureTransform:this.occlusionTextureTransform?.clone(),metallic:this.metallic,roughness:this.roughness,metallicRoughnessTexture:this.metallicRoughnessTexture?.cloneWithDeduplication(e),metallicRoughnessTextureTransform:this.metallicRoughnessTextureTransform?.clone()}}};e$1([y$6({type:h$6,json:{write:!0}})],u$5.prototype,"emissiveColor",void 0),e$1([y$6({type:m$5,json:{write:!0}})],u$5.prototype,"emissiveTexture",void 0),e$1([y$6({type:c$5,json:{write:!0}})],u$5.prototype,"emissiveTextureTransform",void 0),e$1([y$6({type:m$5,json:{write:!0}})],u$5.prototype,"occlusionTexture",void 0),e$1([y$6({type:c$5,json:{write:!0}})],u$5.prototype,"occlusionTextureTransform",void 0),e$1([y$6({type:Number,nonNullable:!0,json:{write:!0},range:{min:0,max:1}})],u$5.prototype,"metallic",void 0),e$1([y$6({type:Number,nonNullable:!0,json:{write:!0},range:{min:0,max:1}})],u$5.prototype,"roughness",void 0),e$1([y$6({type:m$5,json:{write:!0}})],u$5.prototype,"metallicRoughnessTexture",void 0),e$1([y$6({type:c$5,json:{write:!0}})],u$5.prototype,"metallicRoughnessTextureTransform",void 0),u$5=n=e$1([a$3("esri.geometry.support.MeshMaterialMetallicRoughness")],u$5);const c$4=u$5;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
var i$1;const l$3="esri.geometry.support.MeshVertexAttributes",c$3=s.getLogger(l$3);let p$5=i$1=class extends l$4{constructor(t){super(t),this.color=null,this.position=new Float64Array(0),this.uv=null,this.normal=null,this.tangent=null;}castColor(t){return g$5(t,Uint8Array,[Uint8ClampedArray],{loggerTag:".color=",stride:4},c$3)}castPosition(t){t&&t instanceof Float32Array&&c$3.warn(".position=","Setting position attribute from a Float32Array may cause precision problems. Consider storing data in a Float64Array or a regular number array");return g$5(t,Float64Array,[Float32Array],{loggerTag:".position=",stride:3},c$3)}castUv(t){return g$5(t,Float32Array,[Float64Array],{loggerTag:".uv=",stride:2},c$3)}castNormal(t){return g$5(t,Float32Array,[Float64Array],{loggerTag:".normal=",stride:3},c$3)}castTangent(t){return g$5(t,Float32Array,[Float64Array],{loggerTag:".tangent=",stride:4},c$3)}clone(){const t={position:a$4(this.position),uv:a$4(this.uv),normal:a$4(this.normal),tangent:a$4(this.tangent),color:a$4(this.color)};return new i$1(t)}clonePositional(){const t={position:a$4(this.position),normal:a$4(this.normal),tangent:a$4(this.tangent),uv:this.uv,color:this.color};return new i$1(t)}get memoryUsage(){let t=0;return t+=this.position.byteLength,null!=this.uv&&(t+=this.uv.byteLength),null!=this.normal&&(t+=this.normal.byteLength),null!=this.tangent&&(t+=this.tangent.byteLength),null!=this.color&&(t+=this.color.byteLength),t}};function u$4(t,o,r,n){const{loggerTag:e,stride:s}=o;return t.length%s!=0?(n.error(e,`Invalid array length, expected a multiple of ${s}`),new r([])):t}function g$5(t,o,r,n,e){if(!t)return t;if(t instanceof o)return u$4(t,n,o,e);for(const s of r)if(t instanceof s)return u$4(new o(t),n,o,e);if(Array.isArray(t))return u$4(new o(t),n,o,e);{const n=r.map((t=>`'${t.name}'`));return e.error(`Failed to set property, expected one of ${n}, but got ${t.constructor.name}`),new o([])}}function y$5(t,o,r){o[r]=m$4(t);}function m$4(t){const o=new Array(t.length);for(let r=0;r<t.length;r++)o[r]=t[r];return o}e$1([y$6({json:{write:y$5}})],p$5.prototype,"color",void 0),e$1([s$1("color")],p$5.prototype,"castColor",null),e$1([y$6({nonNullable:!0,json:{write:y$5}})],p$5.prototype,"position",void 0),e$1([s$1("position")],p$5.prototype,"castPosition",null),e$1([y$6({json:{write:y$5}})],p$5.prototype,"uv",void 0),e$1([s$1("uv")],p$5.prototype,"castUv",null),e$1([y$6({json:{write:y$5}})],p$5.prototype,"normal",void 0),e$1([s$1("normal")],p$5.prototype,"castNormal",null),e$1([y$6({json:{write:y$5}})],p$5.prototype,"tangent",void 0),e$1([s$1("tangent")],p$5.prototype,"castTangent",null),p$5=i$1=e$1([a$3(l$3)],p$5);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
var p$4;const u$3="esri.geometry.support.MeshComponent",h$4=s.getLogger(u$3);let f$4=p$4=class extends l$4{static from(t){return v$2(p$4,t)}constructor(t){super(t),this.faces=null,this.material=null,this.shading="source",this.trustSourceNormals=!1;}castFaces(t){return g$5(t,Uint32Array,[Uint16Array],{loggerTag:".faces=",stride:3},h$4)}castMaterial(t){return v$2(t&&"object"==typeof t&&("metallic"in t||"roughness"in t||"metallicRoughnessTexture"in t)?c$4:a$2,t)}clone(){return new p$4({faces:a$4(this.faces),shading:this.shading,material:a$4(this.material),trustSourceNormals:this.trustSourceNormals})}cloneWithDeduplication(t,r){const s={faces:a$4(this.faces),shading:this.shading,material:this.material?this.material.cloneWithDeduplication(t,r):null,trustSourceNormals:this.trustSourceNormals};return new p$4(s)}get memoryUsage(){let t=0;return null!=this.faces&&(t+=this.faces.byteLength),null!=this.material&&(t+=this.material.memoryUsage),t}};e$1([y$6({json:{write:!0}})],f$4.prototype,"faces",void 0),e$1([s$1("faces")],f$4.prototype,"castFaces",null),e$1([y$6({type:a$2,json:{write:!0}})],f$4.prototype,"material",void 0),e$1([s$1("material")],f$4.prototype,"castMaterial",null),e$1([y$6({type:String,json:{write:!0}})],f$4.prototype,"shading",void 0),e$1([y$6({type:Boolean})],f$4.prototype,"trustSourceNormals",void 0),f$4=p$4=e$1([a$3(u$3)],f$4);const g$4=f$4;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
function l$2(t$1){const r=f$3(t$1.rings,t$1.hasZ,a$1.CCW_IS_HOLE),l=new Array;let h=0,g=0;for(const o of r.polygons){const t$1=o.count,i=o.index,c=a$5(r.position,3*i,3*t$1),f=o.holeIndices.map((n=>n-i)),a=t(i$3(c,f,3));l.push({position:c,faces:a}),h+=c.length,g+=a.length;}const u=c$2(l,h,g),p=Array.isArray(u.position)?e$2(u.position,3,{originalIndices:u.faces}):e$2(u.position.buffer,6,{originalIndices:u.faces});return u.position=e$3(new Float64Array(p.buffer)),u.faces=p.indices,u}function c$2(n,t$2,e){if(1===n.length)return n[0];const o=t$1(t$2),i=new Array(e);let l=0,c=0,f=0;for(const r of n){for(let n=0;n<r.position.length;n++)o[l++]=r.position[n];for(const n of r.faces)i[c++]=n+f;f=l/3;}return {position:o,faces:t(i)}}function f$3(n,t,e){const o=n.length,s=new Array(o),i=new Array(o),l=new Array(o);let c=0,f=0,u=0,p=0;for(let r=0;r<o;++r)p+=n[r].length;const d=t$1(3*p);let y=0;for(let r=o-1;r>=0;r--){const p=n[r],m=e===a$1.CCW_IS_HOLE&&g$3(p);if(m&&1!==o)s[c++]=p;else {let n=p.length;for(let t=0;t<c;++t)n+=s[t].length;const e={index:y,pathLengths:new Array(c+1),count:n,holeIndices:new Array(c)};e.pathLengths[0]=p.length,p.length>0&&(l[u++]={index:y,count:p.length}),y=m?h$3(p,p.length-1,-1,d,y,p.length,t):h$3(p,0,1,d,y,p.length,t);for(let o=0;o<c;++o){const n=s[o];e.holeIndices[o]=y,e.pathLengths[o+1]=n.length,n.length>0&&(l[u++]={index:y,count:n.length}),y=h$3(n,0,1,d,y,n.length,t);}c=0,e.count>0&&(i[f++]=e);}}for(let r=0;r<c;++r){const n=s[r];n.length>0&&(l[u++]={index:y,count:n.length}),y=h$3(n,0,1,d,y,n.length,t);}return i.length=f,l.length=u,{position:d,polygons:i,outlines:l}}function h$3(n,t,e,o,r,s,i){r*=3;for(let l=0;l<s;++l){const s=n[t];o[r++]=s[0],o[r++]=s[1],o[r++]=i?s[2]:0,t+=e;}return r/3}function g$3(n){return !h$7(n,!1,!1)}var a$1;!function(n){n[n.NONE=0]="NONE",n[n.CCW_IS_HOLE=1]="CCW_IS_HOLE";}(a$1||(a$1={}));

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
function e({xmin:t,xmax:e,ymin:i,ymax:o,zmin:r,zmax:x},l,c,s){r??=0,x??=0,a??=new Float64Array(24);const f=a;return f[0]=t,f[1]=i,f[2]=r,f[3]=t,f[4]=o,f[5]=r,f[6]=e,f[7]=o,f[8]=r,f[9]=e,f[10]=i,f[11]=r,f[12]=t,f[13]=i,f[14]=x,f[15]=t,f[16]=o,f[17]=x,f[18]=e,f[19]=o,f[20]=x,f[21]=e,f[22]=i,f[23]=x,I$2({positions:f,transform:l,vertexSpace:c,inSpatialReference:s,outSpatialReference:s,outPositions:f,local:!1}),m$3(f,s)}let a=null;function m$3(n,e){let a=1/0,m=1/0,i=1/0,o=-1/0,r=-1/0,x=-1/0;const l=n.length;let c=0;for(;c<l;){const t=n[c++],e=n[c++],l=n[c++];a=Math.min(a,t),m=Math.min(m,e),i=Math.min(i,l),o=Math.max(o,t),r=Math.max(r,e),x=Math.max(x,l);}return new M$3({xmin:a,ymin:m,zmin:i,xmax:o,ymax:r,zmax:x,spatialReference:e})}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
const l$1="esri.geometry.support.meshUtils.centerAt";function p$3(e,t,i){if(!e.vertexAttributes||!e.vertexAttributes.position)return;const{vertexSpace:r}=e,o=i?.origin??e.origin;if(r.isRelative)o$1(r,l$1,i),f$2(e,t,o);else {r$2(e.spatialReference,i)?g$2(e,t,o):d$5(e,t,o);}}function f$2(n,s$1,a){const{vertexSpace:c}=n;if(!c.isRelative)return;const p=j$2,f=u$2;if(!In(s$1,f,n.spatialReference))return void s.getLogger(l$1).error(`Failed to project centerAt location (wkid:${s$1.spatialReference.wkid}) to mesh spatial reference (wkid:${n.spatialReference.wkid}). Projection may be possible after calling projection.load().`);if(!In(a,p,n.spatialReference)){const t=n.origin;p[0]=t.x,p[1]=t.y,p[2]=t.z,s.getLogger(l$1).error(`Failed to project specified origin (wkid:${a.spatialReference.wkid}) to mesh spatial reference (wkid:${n.spatialReference.wkid}). Projection may be possible after calling projection.load().`);}const g=e$4(b$3,f,p),d=c.origin;c.origin=u$8(n$2(),d,g);}function g$2(e,t,i){const r=D$3(e.vertexAttributes,i,{geographic:!0}),{position:o,normal:n,tangent:s}=O(r,t,{geographic:!0});e.vertexAttributes.position=o,e.vertexAttributes.normal=n,e.vertexAttributes.tangent=s,e.vertexAttributesChanged();}function d$5(t,i,r){const n=j$2,s$1=u$2;if(In(i,s$1,t.spatialReference)){if(!In(r,n,t.spatialReference)){const i=t.origin;n[0]=i.x,n[1]=i.y,n[2]=i.z,s.getLogger(l$1).error(`Failed to project specified origin (wkid:${r.spatialReference.wkid}) to mesh spatial reference (wkid:${t.spatialReference.wkid}). Projection may be possible after calling projection.load().`);}m$2(t.vertexAttributes.position,s$1,n),t.vertexAttributesChanged();}else s.getLogger(l$1).error(`Failed to project centerAt location (wkid:${i.spatialReference.wkid}) to mesh spatial reference (wkid:${t.spatialReference.wkid}). Projection may be possible after calling projection.load().`);}function m$2(e,t,i){if(e)for(let r=0;r<e.length;r+=3)for(let o=0;o<3;o++)e[r+o]+=t[o]-i[o];}const u$2=n$2(),j$2=n$2(),b$3=n$2();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
async function c$1(e,r,n){const{source:o}=r,{loadGLTFMesh:i}=await p$9(import('./loadGLTFMesh-5186c783.js'),n),a=await f$1(o,n);s$2(n);const c=i(new x$3({x:0,y:0,z:0,spatialReference:e.spatialReference}),a.url,{resolveFile:u$1(a),useTransform:!0,signal:n?.signal});c.then((()=>a.dispose()),(()=>a.dispose()));const{vertexAttributes:m,components:p}=await c;e.vertexAttributes=m,e.components=p;}function u$1(e){const t=Ut(e.url);return s=>{const r=G(s,t,t),n=r?r.replace(/^ *\.\//,""):null;return (n?e.files.get(n):null)??s}}async function f$1(t,s){if(Array.isArray(t)){if(!t.length)throw new s$3("mesh-load-external:missing-assets","There must be at least one file to load");return t[0]instanceof File?h$2(t):w$3(t,s)}return p$2(t)}async function m$1(e,t){const{parts:r}=e;if(1===r.length)return new b$2(r[0].partUrl);const n=await e.toBlob(t);return s$2(t),b$2.fromBlob(n)}function p$2(e){return b$2.fromBlob(e)}function h$2(e){return g$1(e.map((e=>({name:e.name,mimeType:e.type,source:p$2(e)}))))}async function w$3(e,t){const i=await P$2(e.map((async e=>{const r=await m$1(e);return s$2(t),{name:e.assetName,mimeType:e.assetMimeType,source:r}})));if(a$6(t))throw i.forEach((e=>e.source.dispose())),c$7();return g$1(i)}const y$4=/^(model\/gltf\+json)|(model\/gltf-binary)$/,d$4=/\.(gltf|glb)/i;function g$1(t){const s=new Map;let r=null;for(const{name:e,mimeType:n,source:o}of t)(null==r||y$4.test(n)||d$4.test(e))&&(r=o.url),s.set(e,o.url),o.files.forEach(((e,t)=>s.set(t,e)));if(null==r)throw new s$3("mesh-load-external:missing-files","Missing files to load external mesh source");return new b$2(r,(()=>t.forEach((({source:e})=>e.dispose()))),s)}class b$2{constructor(e,t=(()=>{}),s=new Map){this.url=e,this.dispose=t,this.files=s;}static fromBlob(e){const t=URL.createObjectURL(e);return new b$2(t,(()=>URL.revokeObjectURL(t)))}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
let p$1=class extends l$5{constructor(){super(),this.externalSources=new V,this._explicitDisplaySource=null;}get displaySource(){return this._explicitDisplaySource??this._implicitDisplaySource}set displaySource(r){if(null!=r&&!o$2(r))throw new Error("Cannot use this source for display: it is not in a supported format.");this._explicitDisplaySource=r,r&&this.externalSources.every((e=>!h$8(e,r)))&&this.externalSources.add(r);}clearSources(){this.displaySource=null,this.externalSources.removeAll();}getExternalSourcesOnService(r){return this.externalSources.items.filter((e=>m$6(e,r)))}get _implicitDisplaySource(){return this.externalSources.find(o$2)}};e$1([y$6()],p$1.prototype,"externalSources",void 0),e$1([y$6()],p$1.prototype,"displaySource",null),e$1([y$6()],p$1.prototype,"_implicitDisplaySource",null),e$1([y$6()],p$1.prototype,"_explicitDisplaySource",void 0),p$1=e$1([a$3("esri.geometry.support.meshUtils.Metadata")],p$1);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
const v$1="esri.geometry.support.meshUtils.offset";function x$2(t,e,r){if(!t.vertexAttributes||!t.vertexAttributes.position)return;const{vertexSpace:n}=t;if(n.isRelative)o$1(n,v$1,r),j$1(n,e);else {r$2(t.spatialReference,r)?A$2(t,e):b$1(t,e);}}function j$1(t,e){const r=t.origin;t.origin=u$8(n$2(),r,e);}function A$2(e,r){const n=e.spatialReference,i=e.vertexAttributes.position,u=e.vertexAttributes.normal,a=e.vertexAttributes.tangent,v=new Float64Array(i.length),x=null!=u?new Float32Array(u.length):null,j=null!=a?new Float32Array(a.length):null,A=e.extent.center,b=y$3;zn(n,[A.x,A.y,A.z],R$1,c$8(n)),a$7(d$3,R$1),S$2(b,r,d$3),h$9(i,n,v),null!=u&&null!=x&&_(u,i,v,n,x),null!=a&&null!=j&&R$2(a,i,v,n,j),k$2(v,b),E$2(v,i,n),null!=u&&null!=x&&j$3(x,i,v,n,u),null!=a&&null!=j&&v$3(j,i,v,n,a),e.vertexAttributesChanged();}function b$1(t,e){k$2(t.vertexAttributes.position,e),t.vertexAttributesChanged();}function k$2(t,e){if(t)for(let r=0;r<t.length;r+=3)for(let n=0;n<3;n++)t[r+n]+=e[n];}const y$3=n$2(),R$1=e$5(),d$3=e$6();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
function i(){const{faceDescriptions:t,faceVertexOffsets:e,uvScales:n}=y$2,r=4*t.length,o=new Float64Array(3*r),s=new Float32Array(3*r),a=new Float32Array(2*r),i=new Uint32Array(2*t.length*3);let l=0,c=0,f=0,u=0;for(let h=0;h<t.length;h++){const r=t[h],p=l/3;for(const t of e)i[u++]=p+t;const w=r.corners;for(let t=0;t<4;t++){const e=w[t];let i=0;a[f++]=.25*n[t][0]+r.uvOrigin[0],a[f++]=r.uvOrigin[1]-.25*n[t][1];for(let t=0;t<3;t++)0!==r.axis[t]?(o[l++]=.5*r.axis[t],s[c++]=r.axis[t]):(o[l++]=.5*e[i++],s[c++]=0);}}return {position:o,normal:s,uv:a,faces:i}}function l(t,e){const n=t.components[0],r=n.faces,s=d$2[e],a=6*s,i=new Array(6),l=new Array(r.length-6);let c=0,f=0;for(let o=0;o<r.length;o++)o>=a&&o<a+6?i[c++]=r[o]:l[f++]=r[o];if(null!=t.vertexAttributes.uv){const e=new Float32Array(t.vertexAttributes.uv),n=4*s*2,r=[0,1,1,1,1,0,0,0];for(let t=0;t<r.length;t++)e[n+t]=r[t];t.vertexAttributes.uv=e;}return t.components=[new g$4({faces:i,material:n.material}),new g$4({faces:l})],t}function c(t=0){const e=Math.round(8*2**t),n=2*e,r=(e-1)*(n+1)+2*n,o=new Float64Array(3*r),s=new Float32Array(3*r),a=new Float32Array(2*r),i=new Uint32Array(3*((e-1)*n*2));let l=0,c=0,f=0,u=0;for(let h=0;h<=e;h++){const t=h/e*Math.PI+.5*Math.PI,r=Math.cos(t),p=Math.sin(t);M$2[2]=p;const w=0===h||h===e,m=w?n-1:n;for(let v=0;v<=m;v++){const t=v/m*2*Math.PI;M$2[0]=-Math.sin(t)*r,M$2[1]=Math.cos(t)*r;for(let e=0;e<3;e++)o[l]=.5*M$2[e],s[l]=M$2[e],++l;a[c++]=(v+(w?.5:0))/n,a[c++]=h/e,0!==h&&v!==n&&(h!==e&&(i[f++]=u,i[f++]=u+1,i[f++]=u-n),1!==h&&(i[f++]=u,i[f++]=u-n,i[f++]=u-n-1)),u++;}}return {position:o,normal:s,uv:a,faces:i}}function f(t=0){const e=5,n=Math.round(16*2**t),r=(e-1)*(n+1)+2*n,o=new Float64Array(3*r),s=new Float32Array(3*r),a=new Float32Array(2*r),i=new Uint32Array(3*(4*n));let l=0,c=0,f=0,u=0,h=0;for(let p=0;p<=e;p++){const t=0===p||p===e,r=p<=1||p>=e-1,w=2===p||4===p,m=t?n-1:n;for(let v=0;v<=m;v++){const g=v/m*2*Math.PI,A=t?0:.5;M$2[0]=A*Math.sin(g),M$2[1]=A*-Math.cos(g),M$2[2]=p<=2?.5:-.5;for(let t=0;t<3;t++)o[l++]=M$2[t],s[c++]=r?2===t?p<=1?1:-1:0:2===t?0:M$2[t]/A;a[f++]=(v+(t?.5:0))/n,a[f++]=p<=1?1*p/3:p<=3?1*(p-2)/3+1/3:1*(p-4)/3+2/3,w||0===p||v===n||(p!==e&&(i[u++]=h,i[u++]=h+1,i[u++]=h-n),1!==p&&(i[u++]=h,i[u++]=h-n,i[u++]=h-n-1)),h++;}}return {position:o,normal:s,uv:a,faces:i}}function u(t,e){const n="number"==typeof e?e:null!=e?e.width:1,r="number"==typeof e?e:null!=e?e.height:1;switch(t){case"up":case"down":return {width:n,depth:r};case"north":case"south":return {width:n,height:r};case"east":case"west":return {depth:n,height:r}}}function h$1(t){const e=v.facingAxisOrderSwap[t],n=v.position,r=v.normal,o=new Float64Array(n.length),s=new Float32Array(r.length);let a=0;for(let i=0;i<4;i++){const t=a;for(let i=0;i<3;i++){const l=e[i],c=Math.abs(l)-1,f=l>=0?1:-1;o[a]=n[t+c]*f,s[a]=r[t+c]*f,a++;}}return {position:o,normal:s,uv:new Float32Array(v.uv),faces:new Uint32Array(v.faces),isPlane:!0}}const p=1,w$2=2,m=3,v={position:[-.5,-.5,0,.5,-.5,0,.5,.5,0,-.5,.5,0],normal:[0,0,1,0,0,1,0,0,1,0,0,1],uv:[0,1,1,1,1,0,0,0],faces:[0,1,2,0,2,3],facingAxisOrderSwap:{east:[m,p,w$2],west:[-m,-p,w$2],north:[-p,m,w$2],south:[p,-m,w$2],up:[p,w$2,m],down:[p,-w$2,-m]}};function g(t,e,n){t.isPlane||A$1(t),x$1(t,n?.size);const{vertexAttributes:r,vertexSpace:i,transform:l}=q(t,e,n);return {vertexAttributes:new p$5({...r,uv:t.uv}),vertexSpace:i,transform:l,components:[new g$4({faces:t.faces,material:n&&n.material||null})],spatialReference:e.spatialReference}}function A$1(t){for(let e=0;e<t.position.length;e+=3)t.position[e+2]+=.5;}function x$1(t,r){if(null==r)return;const o="number"==typeof r?[r,r,r]:[null!=r.width?r.width:1,null!=r.depth?r.depth:1,null!=r.height?r.height:1];F$1[0]=o[0],F$1[4]=o[1],F$1[8]=o[2];for(let n=0;n<t.position.length;n+=3){for(let e=0;e<3;e++)M$2[e]=t.position[n+e];S$2(M$2,M$2,F$1);for(let e=0;e<3;e++)t.position[n+e]=M$2[e];}if(o[0]!==o[1]||o[1]!==o[2]){F$1[0]=1/o[0],F$1[4]=1/o[1],F$1[8]=1/o[2];for(let r=0;r<t.normal.length;r+=3){for(let e=0;e<3;e++)M$2[e]=t.normal[r+e];S$2(M$2,M$2,F$1),z$1(M$2,M$2);for(let e=0;e<3;e++)t.normal[r+e]=M$2[e];}}}const y$2={faceDescriptions:[{axis:[0,-1,0],uvOrigin:[0,.625],corners:[[-1,-1],[1,-1],[1,1],[-1,1]]},{axis:[1,0,0],uvOrigin:[.25,.625],corners:[[-1,-1],[1,-1],[1,1],[-1,1]]},{axis:[0,1,0],uvOrigin:[.5,.625],corners:[[1,-1],[-1,-1],[-1,1],[1,1]]},{axis:[-1,0,0],uvOrigin:[.75,.625],corners:[[1,-1],[-1,-1],[-1,1],[1,1]]},{axis:[0,0,1],uvOrigin:[0,.375],corners:[[-1,-1],[1,-1],[1,1],[-1,1]]},{axis:[0,0,-1],uvOrigin:[0,.875],corners:[[-1,1],[1,1],[1,-1],[-1,-1]]}],uvScales:[[0,0],[1,0],[1,1],[0,1]],faceVertexOffsets:[0,1,2,0,2,3]},d$2={south:0,east:1,north:2,west:3,up:4,down:5},M$2=n$2(),F$1=e$6();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
const U="esri.geometry.support.meshUtils.rotate";function z(t,e,r){if(!t.vertexAttributes||!t.vertexAttributes.position||0===e[3])return;const{spatialReference:o,vertexSpace:n}=t;if(n.isRelative){o$1(n,U,r);const o=r?.origin??t.origin;t.transform??=new N$1,C(t.transform,n,e,o);}else {const n=r?.origin??t.origin;r$2(o,r)?I$1(t,e,n):$(t,e,n);}}function C(t,e,r,o){const n=e.origin,l=o$3(E$1,o.x,o.y,o.z??0),c=e$4(E$1,l,n);t.applyLocalInverse(c,M$1),t.rotation=g$6(t.rotation,r,h$a()),t.applyLocalInverse(c,c),e$4(c,c,M$1),t.translation=u$8(n$2(),t.translation,c);}function I$1(t,r,o){const n=t.spatialReference,i=c$8(n),s=Z$1;In(o,s,i)||In(t.origin,s,i);const a=t.vertexAttributes.position,c=t.vertexAttributes.normal,f=t.vertexAttributes.tangent,m=new Float64Array(a.length),j=null!=c?new Float32Array(c.length):null,h=null!=f?new Float32Array(f.length):null;zn(i,s,S$1,i),a$7(T$1,S$1);const x=P$1;S$2(x$4(P$1),x$4(r),T$1),x[3]=r[3],h$9(a,n,m),null!=c&&null!=j&&_(c,a,m,n,j),null!=f&&null!=h&&R$2(f,a,m,n,h),D$2(m,x,3,s),E$2(m,a,n),null!=c&&null!=j&&(D$2(j,x,3),j$3(j,a,m,n,c)),null!=f&&null!=h&&(D$2(h,x,4),v$3(h,a,m,n,f)),t.vertexAttributesChanged();}function $(e,r,o){const n=Z$1;if(!In(o,n,e.spatialReference)){const r=e.origin;n[0]=r.x,n[1]=r.y,n[2]=r.z,s.getLogger(U).error(`Failed to project specified origin (wkid:${o.spatialReference.wkid}) to mesh spatial reference (wkid:${e.spatialReference.wkid}). Projection may be possible after calling projection.load().`);}D$2(e.vertexAttributes.position,r,3,n),D$2(e.vertexAttributes.normal,r,3),D$2(e.vertexAttributes.tangent,r,4),e.vertexAttributesChanged();}function D$2(t,e,r,n=f$5){if(null!=t){g$7(S$1,w$4(e),x$4(e));for(let e=0;e<t.length;e+=r){for(let r=0;r<3;r++)E$1[r]=t[e+r]-n[r];O$1(E$1,E$1,S$1);for(let r=0;r<3;r++)t[e+r]=E$1[r]+n[r];}}}const E$1=n$2(),M$1=n$2(),P$1=h$a(),S$1=e$5(),T$1=e$6(),Z$1=n$2();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
const x="esri.geometry.support.meshUtils.scale";function b(e,t,r){if(!e.vertexAttributes||!e.vertexAttributes.position)return;const{spatialReference:o,vertexSpace:n}=e;if(n.isRelative){o$1(n,x,r);const o=r?.origin??e.origin;e.transform??=new N$1,A(e.transform,n,t,o);}else {const n=r$2(o,r),i=r?.origin??e.origin;n?d$1(e,t,i):y$1(e,t,i);}}function A(e,s,l,a){const c=s.origin,p=o$3(R,a.x,a.y,a.z),f=e$4(R,p,c);e.applyLocalInverse(f,k$1);const u=g$8(n$2(),e.scale,l);e.scale=u,e.applyLocalInverse(f,f),e$4(f,f,k$1),e.translation=u$8(n$2(),e.translation,f);}function d$1(e,t,r){const o=e.spatialReference,n=c$8(o),i=F;In(r,i,n)||In(e.origin,i,n);const s=e.vertexAttributes.position,c=e.vertexAttributes.normal,p=e.vertexAttributes.tangent,f=new Float64Array(s.length),x=null!=c?new Float32Array(c.length):null,b=null!=p?new Float32Array(p.length):null;h$9(s,o,f),null!=c&&null!=x&&_(c,s,f,o,x),null!=p&&null!=b&&R$2(p,s,f,o,b),w$1(f,t,i),E$2(f,s,o),null!=c&&null!=x&&j$3(x,s,f,o,c),null!=p&&null!=b&&v$3(b,s,f,o,p),e.vertexAttributesChanged();}function y$1(t,r,o){const n=F;if(!In(o,n,t.spatialReference)){const r=t.origin;n[0]=r.x,n[1]=r.y,n[2]=r.z,s.getLogger(x).error(`Failed to project specified origin (wkid:${o.spatialReference.wkid}) to mesh spatial reference (wkid:${t.spatialReference.wkid}). Projection may be possible after calling projection.load().`);}w$1(t.vertexAttributes.position,r,n),t.vertexAttributesChanged();}function w$1(e,t,r=f$5){if(e)for(let n=0;n<e.length;n+=3){for(let t=0;t<3;t++)R[t]=e[n+t]-r[t];g$8(R,R,t);for(let t=0;t<3;t++)e[n+t]=R[t]+r[t];}}const R=n$2(),k$1=n$2(),F=n$2();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
var B;const k="esri.geometry.Mesh",D$1={base:null,key:"type",defaultKeyValue:"georeferenced",typeMap:{georeferenced:p$a,"georeferenced-relative":m$7,local:m$8}};let N=B=class extends(a$8(_$1.LoadableMixin(m$9(p$b)))){constructor(e){super(e),this.components=null,this.vertexSpace=new p$a,this.transform=null,this.metadata=new p$1,this.hasZ=!0,this.hasM=!1,this.vertexAttributes=new p$5,this.type="mesh";}initialize(){(0===this.metadata.externalSources.length||this.vertexAttributes.position.length)&&(this.loadStatus="loaded"),this.when((()=>{this.handles.add(l$6((()=>({vertexAttributes:this.vertexAttributes,components:this.components?.map((e=>e.clone()))})),(()=>this._clearSources()),{once:!0,sync:!0}));}));}get hasExtent(){return this.loaded?this.vertexAttributes.position.length>0&&(!this.components||this.components.length>0):null!=this.metadata.displaySource?.extent}get _transformedExtent(){const{components:e$1,spatialReference:t,vertexAttributes:r,vertexSpace:o}=this,s=r.position;if(0===s.length||e$1&&0===e$1.length)return new M$3({xmin:0,ymin:0,zmin:0,xmax:0,ymax:0,zmax:0,spatialReference:t});if("local"===o.type){const{_untransformedExtent:e$1,transform:r}=this;return e(e$1,r,o,t)}if("georeferenced-relative"===o.type){const{transform:e}=this,r=I$2({positions:s,transform:e,vertexSpace:o,inSpatialReference:t,outSpatialReference:t,local:!1});return m$3(r,t)}return m$3(s,t)}get _untransformedExtent(){return m$3(this.vertexAttributes.position,this.spatialReference)}get anchor(){const{vertexSpace:e}=this;if(e.isRelative)return e.getOriginPoint(this.spatialReference);const{center:t,zmin:r}=this._transformedExtent;return new x$3({x:t.x,y:t.y,z:r,spatialReference:this.spatialReference})}get origin(){const{vertexSpace:e}=this;return e.isRelative?e.getOriginPoint(this.spatialReference):this._transformedExtent.center}get extent(){return this.loaded||null==this.metadata?.displaySource?.extent?this._transformedExtent:this.metadata.displaySource.extent.clone()}addComponent(e){this.loaded?(this.components||(this.components=[]),this.components.push(g$4.from(e)),this.notifyChange("components")):s.getLogger(this).error("addComponent()","Mesh must be loaded before applying operations");}removeComponent(e){if(this.loaded){if(this.components){const t=this.components.indexOf(e);if(-1!==t)return this.components.splice(t,1),void this.notifyChange("components")}s.getLogger(this).error("removeComponent()","Provided component is not part of the list of components");}else s.getLogger(this).error("removeComponent()","Mesh must be loaded before applying operations");}rotate(e,t,r,o){return l$7(e,t,r,H),z(this,H,o),this}offset(e,t,r,o){return this.loaded?(Z[0]=e,Z[1]=t,Z[2]=r,x$2(this,Z,o),this):(s.getLogger(this).error("offset()","Mesh must be loaded before applying operations"),this)}scale(e,t){return this.loaded?(b(this,e,t),this):(s.getLogger(this).error("scale()","Mesh must be loaded before applying operations"),this)}centerAt(e,t){return this.loaded?(p$3(this,e,t),this):(s.getLogger(this).error("centerAt()","Mesh must be loaded before applying operations"),this)}load(e){const{metadata:{displaySource:t}}=this;return t&&this.addResolvingPromise(c$1(this,t,e)),Promise.resolve(this)}addExternalSources(e){this.metadata.externalSources.addMany(e);}updateDisplaySource(e){this.metadata.displaySource=e;}clone(){return this.cloneWithVertexSpace(this.vertexSpace.clone())}cloneWithVertexSpace(e){let t=null;if(this.components){const e=new Map,r=new Map;t=this.components.map((t=>t.cloneWithDeduplication(e,r)));}const r={components:t,spatialReference:this.spatialReference,vertexAttributes:this.vertexAttributes.clone(),vertexSpace:e,transform:this.transform?.clone()??null,metadata:this.metadata.clone()};return new B(r)}cloneShallow(){return new B({components:this.components,spatialReference:this.spatialReference,vertexAttributes:this.vertexAttributes,vertexSpace:this.vertexSpace.clone(),transform:this.transform,metadata:this.metadata})}vertexAttributesChanged(){this.notifyChange("vertexAttributes");}async toBinaryGLTF(e){const t=import('./gltfexport-b98c9ea8.js'),r=this.load(),o=await Promise.all([t,r]),{toBinaryGLTF:s}=o[0];return s(this,e)}get memoryUsage(){let e=0;if(e+=this.vertexAttributes.memoryUsage,null!=this.components)for(const t of this.components)e+=t.memoryUsage;return e}_clearSources(){this.metadata.clearSources();}static createBox(e,t){if(!(e instanceof x$3))return s.getLogger(k).error(".createBox()","expected location to be a Point instance"),null;const r=new B(g(i(),e,t));return t&&t.imageFace&&"all"!==t.imageFace?l(r,t.imageFace):r}static createSphere(e,t){return e instanceof x$3?new B(g(c(t&&t.densificationFactor||0),e,t)):(s.getLogger(k).error(".createSphere()","expected location to be a Point instance"),null)}static createCylinder(e,t){return e instanceof x$3?new B(g(f(t&&t.densificationFactor||0),e,t)):(s.getLogger(k).error(".createCylinder()","expected location to be a Point instance"),null)}static createPlane(e,t){if(!(e instanceof x$3))return s.getLogger(k).error(".createPlane()","expected location to be a Point instance"),null;const r=t?.facing??"up",o=u(r,t?.size);return new B(g(h$1(r),e,{...t,size:o}))}static createFromPolygon(e,t){if(!(e instanceof j$4))return s.getLogger(k).error(".createFromPolygon()","expected polygon to be a Polygon instance"),null;const r=l$2(e);return new B({vertexAttributes:new p$5({position:r.position}),components:[new g$4({faces:r.faces,shading:"flat",material:t?.material??null})],spatialReference:e.spatialReference,vertexSpace:new p$a})}static async createFromGLTF(e,r,o){if(!(e instanceof x$3))throw s.getLogger(k).error(".createfromGLTF()","expected location to be a Point instance"),new s$3("invalid-input","Expected location to be a Point instance");const{loadGLTFMesh:n}=await p$9(import('./loadGLTFMesh-5186c783.js'),o);return new B(await n(e,r,o))}static async createFromFiles(e,r,o){if(!(e instanceof x$3)){const e="Expected location to be a Point instance";throw s.getLogger(k).error(".createFromFiles()",e),new s$3("invalid-input",e)}const n=B.createWithExternalSource(e,r),i=o?.layer;if(!i){const e="A layer is needed to convert the files";throw s.getLogger(k).error(".createFromFiles()",e),new s$3("invalid-input",e)}const[a]=await i.uploadAssets([n],o);return a}static createWithExternalSource(e,t,r){const o=r?.extent??null,{x:s,y:n,z:i,spatialReference:a}=e,c=r?.transform?.clone()??new N$1,p=r?.vertexSpace??new m$8({origin:[s,n,i??0]}),l={source:t,extent:o},m=new p$1;return m.externalSources.push(l),new B({metadata:m,transform:c,vertexSpace:p,spatialReference:a})}static createIncomplete(e,r){const{x:o,y:s,z:n,spatialReference:i}=e,a=r?.transform?.clone()??new N$1,c=r?.vertexSpace??new m$8({origin:[o,s,n??0]}),p=new B({transform:a,vertexSpace:c,spatialReference:i});return p.addResolvingPromise(Promise.reject(new s$3("mesh-incomplete","Mesh resources are not complete"))),p}};e$1([y$6({type:[g$4],json:{write:!0}})],N.prototype,"components",void 0),e$1([y$6({nonNullable:!0,types:D$1,constructOnly:!0,json:{write:!0}})],N.prototype,"vertexSpace",void 0),e$1([y$6({type:N$1,json:{write:!0}})],N.prototype,"transform",void 0),e$1([y$6({constructOnly:!0})],N.prototype,"metadata",void 0),e$1([y$6()],N.prototype,"hasExtent",null),e$1([y$6()],N.prototype,"_transformedExtent",null),e$1([y$6()],N.prototype,"_untransformedExtent",null),e$1([y$6()],N.prototype,"anchor",null),e$1([y$6()],N.prototype,"origin",null),e$1([y$6({readOnly:!0,json:{read:!1}})],N.prototype,"extent",null),e$1([y$6({readOnly:!0,json:{read:!1,write:!0,default:!0}})],N.prototype,"hasZ",void 0),e$1([y$6({readOnly:!0,json:{read:!1,write:!0,default:!1}})],N.prototype,"hasM",void 0),e$1([y$6({type:p$5,nonNullable:!0,json:{write:!0}})],N.prototype,"vertexAttributes",void 0),N=B=e$1([a$3(k)],N);const Z=n$2(),H=h$a(),I=N;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
const h=()=>s.getLogger("esri.rest.support.meshFeatureSet");function y(t,r,o){const n=o.features;o.features=[],delete o.geometryType;const s=d$7.fromJSON(o);if(s.geometryType="mesh",!o.assetMaps)return s;const i=M(r,o.assetMaps),u=t.sourceSpatialReference??f$6.WGS84,c=o.globalIdFieldName,{outFields:f}=t,m=null!=f&&f.length>0?E(f.includes("*")?null:new Set(f)):()=>({});for(const a of n){const t=S(a,c,u,r,i);null!=t&&s.features.push(new h$b({geometry:t,attributes:m(a)}));}return s}function E(e){return ({attributes:t})=>{if(!t)return {};if(!e)return t;for(const r in t)e.has(r)||delete t[r];return t}}function S(e,t,r,o,i){const a=e.attributes[t],f=i.get(a);if(null==f)return h().error("mesh-feature-set:asset-not-found","Service returned a feature which was not found in the asset map",e),null;if(!e.geometry)return h().error("mesh-feature-set:no-geometry","Service returned a feature without geometry",e),null;const{originPoint:m,originVector:p}=d(e,r,o),l=M$3.fromJSON(e.geometry);l.spatialReference=r;const g=j(e.attributes,o),y=f.projectVertices?new m$7({origin:p}):new m$8({origin:p}),E=T(f);return E?I.createWithExternalSource(m,E,{extent:l,transform:g,vertexSpace:y}):I.createIncomplete(m,{extent:l,transform:g,vertexSpace:y})}function d({attributes:e},t,{transformFieldRoles:r}){const n=e[r.originX],s=e[r.originY],a=e[r.originZ];return {originPoint:new x$3({x:n,y:s,z:a,spatialReference:t}),originVector:r$3(n,s,a)}}function j(e,{transformFieldRoles:t}){return new N$1({translation:[e[t.translationX],-e[t.translationZ],e[t.translationY]],rotationAxis:[e[t.rotationX],e[t.rotationZ],e[t.rotationY]],rotationAngle:e[t.rotationDeg],scale:[e[t.scaleX],e[t.scaleY],e[t.scaleZ]]})}var w;function M(e,t){const o=new Map;for(const n of t){const t=n.parentGlobalId;if(null==t)continue;const s=n.assetName,i=n.assetType,a=n.assetHash,u=n.assetURL,c=n.conversionStatus,f=n.seqNo,m=e$7(i,e.supportedFormats);if(!m){h().error("mesh-feature-set:unknown-format",`Service returned an asset of type ${i}, but it does not list it as a supported type`);continue}const p=r$4(o,t,(()=>({projectVertices:P(n.flags).projectVertices,files:new Map})));r$4(p.files,s,(()=>({name:s,type:i,mimeType:m,status:D(c),parts:[]}))).parts[f]={hash:a,url:u};}return o}function T(e){const t=Array.from(e.files.values()),r=new Array;for(const o of t){if(o.status!==w.COMPLETED)return null;const e=new Array;for(const t of o.parts){if(!t)return null;e.push(new i$4(t.url,t.hash));}r.push(new a$9(o.name,o.mimeType,e));}return r}function D(e){switch(e){case"COMPLETED":case"SUBMITTED":return w.COMPLETED;case"INPROGRESS":return w.PENDING;default:return w.FAILED}}function P(e){return {projectVertices:e.includes("PROJECT_VERTICES")}}!function(e){e[e.FAILED=0]="FAILED",e[e.PENDING=1]="PENDING",e[e.COMPLETED=2]="COMPLETED";}(w||(w={}));

const meshFeatureSet = /*#__PURE__*/Object.freeze({
	__proto__: null,
	assetMapFromAssetMapsJSON: M,
	extractMesh: S,
	meshFeatureSetFromJSON: y
});

export { c$5 as a, meshFeatureSet as b, c$4 as c, g$4 as g, m$5 as m, p$5 as p };

//# sourceMappingURL=meshFeatureSet-65f94c90.js.map