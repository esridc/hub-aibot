import { c7 as s$1, gR as l$1, aI as m, cM as b$1, bW as p, aq as f$1, aH as s$2, bz as S$1, fq as Cn, g_ as Q, g$ as E$1, bq as A$1, gN as p$1, h0 as o$1, h1 as Z$1, ao as v$2, h2 as t$3, h3 as r$1, f as s$3, by as s$4 } from './hub-compass-map-f4225e12.js';
import { P as P$2, $, H, U as U$1, h as ht, d as dt, b as bt, K } from './featureConversionUtils-aa77f433.js';
import { t as t$2 } from './OptimizedGeometry-d99be84d.js';
import { f, g as g$1 } from './projectionSupport-b10f8928.js';

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
const U=new s$1({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),M=Object.freeze({}),O=new t$2,F=new t$2,N=new t$2,_={esriGeometryPoint:P$2,esriGeometryPolyline:$,esriGeometryPolygon:H,esriGeometryMultipoint:U$1};function G$1(e,t,i,r=e.hasZ,n=e.hasM){if(null==t)return null;const o=e.hasZ&&r,s=e.hasM&&n;if(i){const l=ht(N,t,e.hasZ,e.hasM,"esriGeometryPoint",i,r,n);return P$2(l,o,s)}return P$2(t,o,s)}function P$1(e,t,i,r,n,o,s=t,l=i){const a=t&&s,m=i&&l,u=null!=r?"coords"in r?r:r.geometry:null;if(null==u)return null;if(n){let r=dt(F,u,t,i,e,n,s,l);return o&&(r=ht(N,r,a,m,e,o)),_[e]?.(r,a,m)??null}if(o){const r=ht(N,u,t,i,e,o,s,l);return _[e]?.(r,a,m)??null}return bt(O,u,t,i,s,l),_[e]?.(O,a,m)??null}async function v$1(e,t,i){const{outFields:r,orderByFields:n,groupByFieldsForStatistics:o,outStatistics:s}=e;if(r)for(let l=0;l<r.length;l++)r[l]=r[l].trim();if(n)for(let l=0;l<n.length;l++)n[l]=n[l].trim();if(o)for(let l=0;l<o.length;l++)o[l]=o[l].trim();if(s)for(let l=0;l<s.length;l++)s[l].onStatisticField&&(s[l].onStatisticField=s[l].onStatisticField.trim());return e.geometry&&!e.outSR&&(e.outSR=e.geometry.spatialReference),z(e,t,i)}async function z(e,t,i){if(!e)return null;let{where:o}=e;if(e.where=o=o&&o.trim(),(!o||/^1 *= *1$/.test(o)||t&&t===o)&&(e.where=null),!e.geometry)return e;let s=await A(e);if(e.distance=0,e.units=null,"esriSpatialRelEnvelopeIntersects"===e.spatialRel){const{spatialReference:t}=e.geometry;s=l$1(s),s.spatialReference=t;}if(s){await f(s.spatialReference,i),s=b(s,i);const t=(await b$1(p(s)))[0];if(null==t)throw M;const r="quantizationParameters"in e&&e.quantizationParameters?.tolerance||"maxAllowableOffset"in e&&e.maxAllowableOffset||0,o=r&&J(s,i)?{densificationStep:8*r}:void 0,l=t.toJSON(),m=await g$1(l,l.spatialReference,i,o);if(!m)throw M;m.spatialReference=i,e.geometry=m;}return e}function J(e,t){if(!e)return !1;const r=e.spatialReference;return (m(e)||f$1(e)||s$2(e))&&!S$1(r,t)&&!Cn(r,t)}function b(e,t){const i=e.spatialReference;return J(e,t)&&m(e)?{spatialReference:i,rings:[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]}:e}async function A(e){const{distance:i,units:r}=e,n=e.geometry;if(null==i||"vertexAttributes"in n)return n;const o=n.spatialReference,s=r?U.fromJSON(r):Q(o),l=o&&(E$1(o)||A$1(o))?n:await f(o,p$1).then((()=>g$1(n,p$1)));return (await B())(l.spatialReference,l,i,s)}async function B(){return (await import('./geometryEngineJSON-dda25823.js')).geodesicBuffer}function Z(e){return e&&q in e?JSON.parse(JSON.stringify(e,E)):e}const q="_geVersion",E=(e,t)=>e!==q?t:void 0;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
function s(s){return "mesh"===s?o$1:Z$1(s)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
function n$1(n,t){return n?t?4:3:t?3:2}function t$1(n,t,r,e){return o(n,t,r,e.coords[0],e.coords[1])}function r(t,r,e,c,u,f){const s=n$1(u,f),{coords:i,lengths:l}=c;if(!l)return !1;for(let n=0,d=0;n<l.length;n++,d+=s)if(!o(t,r,e,i[d],i[d+1]))return !1;return !0}function o(t,r,o,c,u){if(!t)return !1;const f=n$1(r,o),{coords:s,lengths:i}=t;let l=!1,d=0;for(const n of i)l=e$1(l,s,f,d,n,c,u),d+=n*f;return l}function e$1(n,t,r,o,e,c,u){let f=n,s=o;for(let i=o,l=o+e*r;i<l;i+=r){s=i+r,s===l&&(s=o);const n=t[i],e=t[i+1],d=t[s],g=t[s+1];(e<u&&g>=u||g<u&&e>=u)&&n+(u-e)/(g-e)*(d-n)<c&&(f=!f);}return f}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
const c="feature-store:unsupported-query",R={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},S={spatialRelationship:{esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},queryGeometry:{esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},layerGeometry:{esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1}};function G(e){return null!=e&&!0===S.spatialRelationship[e]}function g(e){return null!=e&&!0===S.queryGeometry[v$2(e)]}function j(e){return null!=e&&!0===S.layerGeometry[e]}function h(){return import('./geometryEngineJSON-dda25823.js')}function v(e,n,l,y,c){if(f$1(n)&&"esriGeometryPoint"===l&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e)){const e=K(new t$2,n,!1,!1);return Promise.resolve((r=>t$1(e,!1,!1,r)))}if(f$1(n)&&"esriGeometryMultipoint"===l){const r$1=K(new t$2,n,!1,!1);if("esriSpatialRelContains"===e)return Promise.resolve((e=>r(r$1,!1,!1,e,y,c)))}if(m(n)&&"esriGeometryPoint"===l&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e))return Promise.resolve((e=>t$3(n,P$1(l,y,c,e))));if(m(n)&&"esriGeometryMultipoint"===l&&"esriSpatialRelContains"===e)return Promise.resolve((e=>r$1(n,P$1(l,y,c,e))));if(m(n)&&"esriSpatialRelIntersects"===e){const e=s(l);return Promise.resolve((r=>e(n,P$1(l,y,c,r))))}return h().then((r=>{const t=r[R[e]].bind(null,n.spatialReference,n);return e=>t(P$1(l,y,c,e))}))}async function P(r,t,i){const{spatialRel:s,geometry:o}=r;if(o){if(!G(s))throw new s$3(c,"Unsupported query spatial relationship",{query:r});if(s$4(o.spatialReference)&&s$4(i)){if(!g(o))throw new s$3(c,"Unsupported query geometry type",{query:r});if(!j(t))throw new s$3(c,"Unsupported layer geometry type",{query:r});if(r.outSR)return f(r.geometry&&r.geometry.spatialReference,r.outSR)}}}function I(e){if(m(e))return !0;if(f$1(e)){for(const r of e.rings){if(5!==r.length)return !1;if(r[0][0]!==r[1][0]||r[0][0]!==r[4][0]||r[2][0]!==r[3][0]||r[0][1]!==r[3][1]||r[0][1]!==r[4][1]||r[1][1]!==r[2][1])return !1}return !0}return !1}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
async function t(t,n){if(!t)return null;const e=n.featureAdapter,{startTimeField:u,endTimeField:l}=t;let r=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;if(u&&l)await n.forEach((t=>{const n=e.getAttribute(t,u),a=e.getAttribute(t,l);null==n||isNaN(n)||(r=Math.min(r,n)),null==a||isNaN(a)||(i=Math.max(i,a));}));else {const t=u||l;await n.forEach((n=>{const u=e.getAttribute(n,t);null==u||isNaN(u)||(r=Math.min(r,u),i=Math.max(i,u));}));}return {start:r,end:i}}function n(t,n,r){if(!n||!t)return null;const{startTimeField:i,endTimeField:a}=t;if(!i&&!a)return null;const{start:o,end:s}=n;return null===o&&null===s?null:void 0===o&&void 0===s?l():i&&a?e(r,i,a,o,s):u(r,i||a,o,s)}function e(t,n,e,u,l){return null!=u&&null!=l?r=>{const i=t.getAttribute(r,n),a=t.getAttribute(r,e);return (null==i||i<=l)&&(null==a||a>=u)}:null!=u?n=>{const l=t.getAttribute(n,e);return null==l||l>=u}:null!=l?e=>{const u=t.getAttribute(e,n);return null==u||u<=l}:void 0}function u(t,n,e,u){return null!=e&&null!=u&&e===u?u=>t.getAttribute(u,n)===e:null!=e&&null!=u?l=>{const r=t.getAttribute(l,n);return r>=e&&r<=u}:null!=e?u=>t.getAttribute(u,n)>=e:null!=u?e=>t.getAttribute(e,n)<=u:void 0}function l(){return ()=>!1}

export { G$1 as G, I, M, P$1 as P, Z, v as a, P as b, n, t, v$1 as v, z };

//# sourceMappingURL=timeSupport-ec5a6871.js.map