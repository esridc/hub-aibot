{"version":3,"names":["hubAibotCss","HubAibot","async","message","this","messages","response","fetch","method","headers","Authorization","apikey","body","JSON","stringify","model","role","content","temperature","data","json","text","_b","_a","choices","console","debug","toggleChat","chatOpen","handleKeyDown","event","key","shiftKey","preventDefault","chatbotRef","textContent","trim","sendMessage","render","h","class","map","innerHTML","replace","contentEditable","onKeyDown","ref","el","onClick"],"sources":["./src/components/hub-aibot/hub-aibot.css?tag=hub-aibot&encapsulation=shadow","./src/components/hub-aibot/hub-aibot.tsx"],"sourcesContent":[":host {\n  display: block;\n  position: fixed;\n  bottom: 20px;\n  right: 20px;\n  z-index: 9999;\n}\n\n.fab {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 56px;\n  height: 56px;\n  border-radius: 50%;\n  background-color: #0077c2;\n  box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);\n  color: white;\n  font-size: 28px;\n  cursor: pointer;\n}\n\n.chat-window {\n  position: fixed;\n  bottom: 90px;\n  right: 20px;\n  width: 350px;\n  height: 400px;\n  border-radius: 10px;\n  background-color: white;\n  box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);\n  overflow: hidden;\n}\n\n.messages {\n  padding: 10px;\n  height: 330px;\n  overflow-y: scroll;\n}\n\n.message {\n  margin-bottom: 10px;\n  padding: 10px;\n  border-radius: 10px;\n  background-color: #f5f5f5;\n}\n\n.input {\n  padding: 10px;\n  height: 60px;\n  border-top: 1px solid #e0e0e0;\n  outline: none;\n}\n\n.language-buttons {\n  display: flex;\n  justify-content: center;\n  margin-top: 10px;\n}\n\n.language-buttons button {\n  margin: 0 5px;\n  padding: 5px 10px;\n  border: none;\n  border-radius: 20px;\n  border-color: #0077c2;\n  background-color: white;\n  color: white;\n  font-size: 14px;\n  cursor: pointer;\n}\n\n.language-buttons button:focus {\n  outline: none;\n}\n\n.language-buttons button:active {\n  background-color: #005da8;\n}","import { Component, h, Prop, State } from '@stencil/core';\n\n@Component({\n  tag: 'hub-aibot',\n  styleUrl: 'hub-aibot.css',\n  shadow: true,\n})\nexport class HubAibot {\n  private chatbotRef!: HTMLDivElement;\n\n  @Prop() apikey = '';\n  @State() chatOpen = false;\n  @State() messages: string[] = [];\n\n  private async sendMessage(message: string) {\n    this.messages = [...this.messages, message];\n\n    const response = await fetch('https://api.openai.com/v1/chat/completions', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `Bearer ${this.apikey}`,\n      },\n      body: JSON.stringify({\n        model: \"gpt-3.5-turbo\",\n        messages: [{role: \"user\", content: message}],\n        temperature: 0.7\n      }),\n    });\n\n    const data = await response.json();\n    const text = data.choices[0]?.message?.content;\n\n    console.debug(\"response\", {text})\n    this.messages = [...this.messages, text];\n  }\n\n  private toggleChat() {\n    this.chatOpen = !this.chatOpen;\n  }\n\n  private handleKeyDown(event: KeyboardEvent) {\n    if (event.key === 'Enter' && event.shiftKey === false) {\n      event.preventDefault();\n      const message = this.chatbotRef.textContent?.trim() || '';\n      this.sendMessage(message);\n      this.chatbotRef.textContent = '';\n    }\n  }\n\n  render() {\n    return (\n      <div>\n        {this.chatOpen ? (\n          <div class=\"chat-window\">\n            <div class=\"messages\">\n              {this.messages.map((message) => (\n                <div class=\"message\" innerHTML={message.replace(/(?:\\r\\n|\\r|\\n)/g, '<br>')}></div>\n              ))}\n            </div>\n            <div\n              class=\"input\"\n              contentEditable={true}\n              onKeyDown={(event: KeyboardEvent) => this.handleKeyDown(event)}\n              ref={(el) => (this.chatbotRef = el!)}\n            ></div>\n          </div>\n        ) : null}\n        <div class=\"fab\" onClick={() => this.toggleChat()}>\n          <span class=\"material-icons\">&#129302;</span>\n        </div>\n      </div>\n    );\n  }\n}"],"mappings":"2CAAA,MAAMA,EAAc,0/B,MCOPC,EAAQ,M,qCAGF,G,cACG,M,cACU,E,CAEtBC,kBAAkBC,G,QACxBC,KAAKC,SAAW,IAAID,KAAKC,SAAUF,GAEnC,MAAMG,QAAiBC,MAAM,6CAA8C,CACzEC,OAAQ,OACRC,QAAS,CACP,eAAgB,mBAChBC,cAAiB,UAAUN,KAAKO,UAElCC,KAAMC,KAAKC,UAAU,CACnBC,MAAO,gBACPV,SAAU,CAAC,CAACW,KAAM,OAAQC,QAASd,IACnCe,YAAa,OAIjB,MAAMC,QAAab,EAASc,OAC5B,MAAMC,GAAOC,GAAAC,EAAAJ,EAAKK,QAAQ,MAAE,MAAAD,SAAA,SAAAA,EAAEpB,WAAO,MAAAmB,SAAA,SAAAA,EAAEL,QAEvCQ,QAAQC,MAAM,WAAY,CAACL,SAC3BjB,KAAKC,SAAW,IAAID,KAAKC,SAAUgB,E,CAG7BM,aACNvB,KAAKwB,UAAYxB,KAAKwB,Q,CAGhBC,cAAcC,G,MACpB,GAAIA,EAAMC,MAAQ,SAAWD,EAAME,WAAa,MAAO,CACrDF,EAAMG,iBACN,MAAM9B,IAAUoB,EAAAnB,KAAK8B,WAAWC,eAAW,MAAAZ,SAAA,SAAAA,EAAEa,SAAU,GACvDhC,KAAKiC,YAAYlC,GACjBC,KAAK8B,WAAWC,YAAc,E,EAIlCG,SACE,OACEC,EAAA,WACGnC,KAAKwB,SACJW,EAAA,OAAKC,MAAM,eACTD,EAAA,OAAKC,MAAM,YACRpC,KAAKC,SAASoC,KAAKtC,GAClBoC,EAAA,OAAKC,MAAM,UAAUE,UAAWvC,EAAQwC,QAAQ,kBAAmB,aAGvEJ,EAAA,OACEC,MAAM,QACNI,gBAAiB,KACjBC,UAAYf,GAAyB1B,KAAKyB,cAAcC,GACxDgB,IAAMC,GAAQ3C,KAAK8B,WAAaa,KAGlC,KACJR,EAAA,OAAKC,MAAM,MAAMQ,QAAS,IAAM5C,KAAKuB,cACnCY,EAAA,QAAMC,MAAM,kBAAgB,O"}